"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6069],{4022:(e,t,n)=>{n.d(t,{P:()=>a,R:()=>s});var r=n(42500);let a=(0,n(12115).createContext)(null),s=(0,r.eU)(null)},6759:(e,t,n)=>{n.d(t,{cu:()=>D,fw:()=>w,gS:()=>k});var r=n(95155),a=n(10554),s=n(28296),l=n(14490),o=n(37817),i=n(5249),c=n(50558),d=n(84127),u=n(76049),m=n(39797),f=n(93715),h=n(23862),x=n(28382),p=n(23925),g=n(29972),v=n(17068),_=n(42500),y=n(29724),b=n(12115),E=n(78453),S=n(70376),N=n(75780),C=n(66380),A=n(69554);let j=(0,_.eU)(!1),w=(0,_.eU)(!1),D=(0,_.eU)(!1);function k(e){var t,n,_,k,R;let I=(0,o.v1)(),[L,T]=(0,y.fp)(j),[O,U]=(0,y.fp)(D),{data:P,isLoading:F,refetch:W}=(0,a.A2)(!!I&&!(null==I||null==(n=I.settings)||null==(t=n.library)?void 0:t.disableUpdateCheck));(0,l.oA)({type:h.c.CHECK_FOR_UPDATES,onMessage:()=>{W().then(()=>X())}});let[M,G]=b.useState(!0),[z,B]=b.useState(null),[V,K]=b.useState(""),[Y,H]=(0,y.fp)(w),X=b.useCallback(()=>{try{(async()=>{try{let e=await (0,v.z)();B(e),G(!1)}catch(e){(0,f.v)("TAURI").error("Failed to check for updates",e),K(JSON.stringify(e)),G(!1)}})()}catch(e){(0,f.v)("TAURI").error("Failed to check for updates",e),U(!1)}},[]);b.useEffect(()=>{X()},[]);let[q,J]=b.useState("");async function $(){if(z&&!O)try{U(!0),A.oR.info("Downloading update..."),await z.download(),A.oR.info("Shutting down server..."),await (0,x.Ic)("kill-server"),A.oR.info("Installing update..."),setTimeout(async()=>{await z.install(),H(!0),"macos"===q?A.oR.info("Update installed. Please reopen the app."):A.oR.info("Relaunching app..."),await (0,g.b)()},1e3)}catch(e){(0,f.v)("TAURI").error("Failed to download update",e),A.oR.error("Failed to download update: ".concat(JSON.stringify(e))),U(!1)}}return(b.useEffect(()=>{(async()=>{J((0,p.iD)())})()},[]),b.useEffect(()=>{P&&P.release&&T(!0)},[P]),(null==I||null==(k=I.settings)||null==(_=k.library)?void 0:_.disableUpdateCheck)||F||M||!P||!P.release)?null:Y?(0,r.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-[--background] flex items-center z-[9999]",children:(0,r.jsxs)("div",{className:"container max-w-4xl py-10",children:[(0,r.jsx)("div",{className:"mb-4 flex justify-center w-full",children:(0,r.jsx)("img",{src:"/logo_2.png",alt:"logo",className:"w-36 h-auto"})}),(0,r.jsx)("p",{className:"text-center text-lg",children:"Update installed. Please reopen the app if it doesn't restart automatically."})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.m,{collapsed:e.collapsed,items:[{iconType:E.$S7,name:"Update available",onClick:()=>T(!0)}],itemIconClass:"text-brand-300"}),(0,r.jsx)(u.a,{open:L,onOpenChange:e=>!O&&T(e),contentClass:"max-w-3xl",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-center",children:"A new update is available!"}),(0,r.jsxs)("h4",{className:"font-bold flex gap-2 text-center items-center justify-center",children:[(0,r.jsx)("span",{className:"text-[--muted]",children:P.current_version})," ",(0,r.jsx)(N.dyV,{}),(0,r.jsx)("span",{className:"text-indigo-200",children:P.release.version})]}),!z&&(0,r.jsx)(c.F,{intent:"warning",children:"This update is not yet available for desktop clients. Wait a few minutes or check the GitHub page for more information."}),(0,r.jsx)(s.O,{updateData:P}),(0,r.jsxs)("div",{className:"flex gap-2 w-full !mt-4",children:[!!z&&(0,r.jsx)(d.$n,{leftIcon:(0,r.jsx)(C.$Wp,{className:"text-2xl"}),onClick:$,loading:O,disabled:F,children:"Update now"}),(0,r.jsx)("div",{className:"flex flex-1"}),(0,r.jsx)(i.i,{href:(null==P||null==(R=P.release)?void 0:R.html_url)||"",target:"_blank",children:(0,r.jsx)(d.$n,{intent:"white-subtle",rightIcon:(0,r.jsx)(S.zaF,{}),children:"See on GitHub"})})]})]})})]})}},10554:(e,t,n)=>{n.d(t,{A2:()=>i,G9:()=>d,zf:()=>c});var r=n(19749),a=n(7675),s=n(74889),l=n(37817),o=n(69554);function i(e){let t,n,l=(0,r.c)(3);return l[0]===Symbol.for("react.memo_cache_sentinel")?(t=[s.S.RELEASES.GetLatestUpdate.key],l[0]=t):t=l[0],l[1]!==e?(n={endpoint:s.S.RELEASES.GetLatestUpdate.endpoint,method:s.S.RELEASES.GetLatestUpdate.methods[0],queryKey:t,enabled:e},l[1]=e,l[2]=n):n=l[2],(0,a.fl)(n)}function c(){let e,t,n=(0,r.c)(3),i=(0,l.LX)();return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[s.S.RELEASES.InstallLatestUpdate.key],n[0]=e):e=n[0],n[1]!==i?(t={endpoint:s.S.RELEASES.InstallLatestUpdate.endpoint,method:s.S.RELEASES.InstallLatestUpdate.methods[0],mutationKey:e,onSuccess:async e=>{i(e),o.oR.info("Installing update...")}},n[1]=i,n[2]=t):t=n[2],(0,a.qk)(t)}function d(e,t,n){let l,o,i=(0,r.c)(4),c=s.S.RELEASES.GetChangelog.endpoint+"?before=".concat(e,"&after=").concat(t);return i[0]===Symbol.for("react.memo_cache_sentinel")?(l=[s.S.RELEASES.GetChangelog.key],i[0]=l):l=i[0],i[1]!==n||i[2]!==c?(o={endpoint:c,method:s.S.RELEASES.GetChangelog.methods[0],queryKey:l,enabled:n},i[1]=n,i[2]=c,i[3]=o):o=i[3],(0,a.fl)(o)}},14490:(e,t,n)=>{n.d(t,{Y0:()=>c,hn:()=>u,oA:()=>d});var r=n(19749),a=n(4022),s=n(73826),l=n(93715),o=n(29724),i=n(12115);function c(){let e,t,n,c,d,u,m,f,h=(0,r.c)(16),x=(0,i.useContext)(a.P),[p]=(0,o.fp)(s.O1),[g]=(0,o.fp)(s.ST);h[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],h[0]=e):e=h[0];let v=(0,i.useRef)(e),_=(0,i.useRef)(null),y=(0,i.useRef)(null);h[1]!==x?(t=[x],h[1]=x,h[2]=t):t=h[2],(0,i.useEffect)(()=>{y.current=x,x&&x.readyState===WebSocket.OPEN&&v.current.length>0&&setTimeout(()=>N(),100)},t);let b=null==x?void 0:x.readyState;h[3]!==b?(n=[b],h[3]=b,h[4]=n):n=h[4],(0,i.useEffect)(()=>{x&&x.readyState===WebSocket.OPEN&&v.current.length>0&&setTimeout(()=>N(),100)},n),h[5]===Symbol.for("react.memo_cache_sentinel")?(c=function(e){if(void 0===e)return"UNDEFINED";switch(e){case WebSocket.CONNECTING:return"CONNECTING";case WebSocket.OPEN:return"OPEN";case WebSocket.CLOSING:return"CLOSING";case WebSocket.CLOSED:return"CLOSED";default:return"UNKNOWN (".concat(e,")")}},h[5]=c):c=h[5];let E=c,S=function(e){let t=y.current;if(!t||t.readyState!==WebSocket.OPEN)return v.current.length<500?(v.current.push(e),(0,l.v)("WebsocketSender").info("Queued message of type ".concat(e.type,", queue size: ").concat(v.current.length,", socket state: ").concat(t?E(t.readyState):"null"))):(0,l.v)("WebsocketSender").warning("Message queue full (500), dropping message of type ".concat(e.type)),_.current||N(),!1;try{let n=JSON.stringify({...e,clientId:p});return t.send(n),!0}catch(t){return v.current.push(e),!1}};function N(){_.current&&(clearTimeout(_.current),_.current=null);let e=y.current;if(e&&e.readyState===WebSocket.OPEN&&v.current.length>0){let t=[...v.current],n=[];t.forEach((t,r)=>{try{let a=JSON.stringify({...t,clientId:p});e.send(a),n.push(r)}catch(e){}}),n.length>0&&(v.current=t.filter((e,t)=>!n.includes(t)))}v.current.length>0||!e||e.readyState!==WebSocket.OPEN?_.current=setTimeout(()=>{N()},1e3):_.current=null}return h[6]!==g||h[7]!==N?(d=()=>{var e;return g&&(null==(e=y.current)?void 0:e.readyState)===WebSocket.OPEN&&setTimeout(()=>N(),100),()=>{_.current&&(clearTimeout(_.current),_.current=null)}},h[6]=g,h[7]=N,h[8]=d):d=h[8],h[9]!==g?(u=[g],h[9]=g,h[10]=u):u=h[10],(0,i.useEffect)(d,u),h[11]!==S?(m=(e,t,n)=>S({type:"plugin",payload:{type:e,extensionId:n,payload:t}}),h[11]=S,h[12]=m):m=h[12],h[13]!==S||h[14]!==m?(f={sendMessage:S,sendPluginMessage:m},h[13]=S,h[14]=m,h[15]=f):f=h[15],f}function d(e){let{type:t,onMessage:n}=e,r=(0,i.useContext)(a.P);return(0,i.useEffect)(()=>{if(r){let e=e=>{try{let r=JSON.parse(e.data);r.type&&r.type===t&&n(r.payload)}catch(e){(0,l.v)("Websocket").error("Error parsing message",e)}};return r.addEventListener("message",e),()=>{r.removeEventListener("message",e)}}},[r,n]),null}function u(e){let{type:t,extensionId:n,onMessage:r}=e,s=(0,i.useContext)(a.P);return(0,i.useEffect)(()=>{if(s){let e=e=>{try{let a=JSON.parse(e.data);if(a.type&&"plugin"===a.type){let e=a.payload;e.type===t&&(e.extensionId===n||""===n)&&r(e.payload,e.extensionId)}}catch(e){(0,l.v)("Websocket").error("Error parsing message",e)}};return s.addEventListener("message",e),()=>{s.removeEventListener("message",e)}}},[s,r]),null}},15388:(e,t,n)=>{n.d(t,{_s:()=>p,EQ:()=>h});var r=n(95155),a=n(19749),s=n(58181),l=n(83475),o=n(21335),i=n(42500),c=n(29724),d=n(12115),u=n(84127),m=n(91360),f=n(38310);let h=(0,i.eU)([]),x=(0,m.u)({overlay:(0,o.F)(["UI-Drawer__overlay","fixed inset-0 z-[50] bg-black/80","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"]),content:(0,o.F)(["UI-Drawer__content","fixed z-50 w-full gap-4 bg-[--background] p-6 shadow-lg overflow-y-auto","transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-500 data-[state=open]:duration-500","focus:outline-none focus-visible:outline-none","desktop"===f.env.NEXT_PUBLIC_PLATFORM&&"select-none"],{variants:{side:{mangaReader:"w-full inset-x-0 top-0 border data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",top:"w-full lg:w-[calc(100%_-_20px)] inset-x-0 top-0 border data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"w-full lg:w-[calc(100%_-_20px)] inset-x-0 bottom-0 border data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full lg:h-[calc(100%_-_20px)] border data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left",right:"inset-y-0 right-0 h-full lg:h-[calc(100%_-_20px)] border data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right"},size:{sm:null,md:null,lg:null,xl:null,full:null}},defaultVariants:{side:"right",size:"md"},compoundVariants:[{size:"sm",side:"left",className:"sm:max-w-sm"},{size:"sm",side:"right",className:"sm:max-w-sm"},{size:"md",side:"left",className:"sm:max-w-md"},{size:"md",side:"right",className:"sm:max-w-md"},{size:"lg",side:"left",className:"sm:max-w-2xl"},{size:"lg",side:"right",className:"sm:max-w-2xl"},{size:"xl",side:"left",className:"sm:max-w-5xl"},{size:"xl",side:"right",className:"sm:max-w-5xl"},{size:"full",side:"top",className:"h-dvh"},{size:"full",side:"bottom",className:"h-dvh"}]}),close:(0,o.F)(["UI-Drawer__close","absolute right-4 top-4"]),header:(0,o.F)(["UI-Drawer__header","flex flex-col space-y-1.5 text-center sm:text-left"]),footer:(0,o.F)(["UI-Drawer__footer","flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2"]),title:(0,o.F)(["UI-Drawer__title","text-xl font-semibold leading-none tracking-tight"]),description:(0,o.F)(["UI-Drawer__description","text-sm text-[--muted]"])});function p(e){let t,n,o,i,p,g,v,_,y,b,E,S,N,C,A,j,w,D,k,R,I,L,T,O,U,P,F,W,M,G,z,B,V,K,Y,H,X,q,J,$=(0,a.c)(76);$[0]!==e?({allowOutsideInteraction:L,trigger:P,title:O,footer:v,description:p,children:t,closeButton:n,overlayClass:D,contentClass:i,closeClass:o,headerClass:y,footerClass:_,titleClass:U,descriptionClass:g,hideCloseButton:b,side:T,size:I,open:w,onOpenAutoFocus:A,onCloseAutoFocus:S,onEscapeKeyDown:N,onPointerDownCapture:j,onInteractOutside:C,portalContainer:k,mangaReader:E,...R}=e,$[0]=e,$[1]=t,$[2]=n,$[3]=o,$[4]=i,$[5]=p,$[6]=g,$[7]=v,$[8]=_,$[9]=y,$[10]=b,$[11]=E,$[12]=S,$[13]=N,$[14]=C,$[15]=A,$[16]=j,$[17]=w,$[18]=D,$[19]=k,$[20]=R,$[21]=I,$[22]=L,$[23]=T,$[24]=O,$[25]=U,$[26]=P):(t=$[1],n=$[2],o=$[3],i=$[4],p=$[5],g=$[6],v=$[7],_=$[8],y=$[9],b=$[10],E=$[11],S=$[12],N=$[13],C=$[14],A=$[15],j=$[16],w=$[17],D=$[18],k=$[19],R=$[20],I=$[21],L=$[22],T=$[23],O=$[24],U=$[25],P=$[26]);let Q=void 0!==L&&L,Z=void 0===T?"right":T;var ee=d.useId(),et=w;let en=(0,a.c)(6),[,er]=(0,c.fp)(h);en[0]!==ee||en[1]!==et||en[2]!==er?(q=()=>{if(document.querySelector("body"))return et?er(e=>[...e,ee]):er(e=>e.filter(e=>e!==ee)),()=>{er(e=>e.filter(e=>e!==ee))}},en[0]=ee,en[1]=et,en[2]=er,en[3]=q):q=en[3],en[4]!==et?(J=[et],en[4]=et,en[5]=J):J=en[5],d.useEffect(q,J);let ea=!Q;$[27]!==P?(F=P&&(0,r.jsx)(s.l9,{asChild:!0,children:P}),$[27]=P,$[28]=F):F=$[28],$[29]!==D?(W=(0,m.cn)(x.overlay(),D),$[29]=D,$[30]=W):W=$[30],$[31]!==W?(M=(0,r.jsx)(s.hJ,{className:W}),$[31]=W,$[32]=M):M=$[32],$[33]!==i||$[34]!==E||$[35]!==Z||$[36]!==I?(G=(0,m.cn)(x.content({size:I,side:E?"mangaReader":Z}),!E&&"lg:m-[10px] rounded-[--radius]",i),$[33]=i,$[34]=E,$[35]=Z,$[36]=I,$[37]=G):G=$[37];let es="desktop"!==f.env.NEXT_PUBLIC_PLATFORM||E?void 0:"30px",el="desktop"!==f.env.NEXT_PUBLIC_PLATFORM||E||"left"!==Z&&"right"!==Z?void 0:"calc(100dvh - 50px)";return $[38]!==es||$[39]!==el?(z={marginTop:es,height:el},$[38]=es,$[39]=el,$[40]=z):z=$[40],$[41]!==p||$[42]!==g||$[43]!==y||$[44]!==O||$[45]!==U?(B=O||p?(0,r.jsxs)("div",{className:(0,m.cn)(x.header(),y),children:[(0,r.jsx)(s.hE,{className:(0,m.cn)(x.title(),"desktop"===f.env.NEXT_PUBLIC_PLATFORM&&"relative",U),children:O}),p&&(0,r.jsx)(s.VY,{className:(0,m.cn)(x.description(),g),children:p})]}):(0,r.jsx)(l.s,{children:(0,r.jsx)(s.hE,{children:"Drawer"})}),$[41]=p,$[42]=g,$[43]=y,$[44]=O,$[45]=U,$[46]=B):B=$[46],$[47]!==v||$[48]!==_?(V=v&&(0,r.jsx)("div",{className:(0,m.cn)(x.footer(),_),children:v}),$[47]=v,$[48]=_,$[49]=V):V=$[49],$[50]!==n||$[51]!==o||$[52]!==b?(K=!b&&(0,r.jsx)(s.bm,{className:(0,m.cn)(x.close(),o),asChild:!0,children:n||(0,r.jsx)(u.Jn,{})}),$[50]=n,$[51]=o,$[52]=b,$[53]=K):K=$[53],$[54]!==t||$[55]!==S||$[56]!==N||$[57]!==C||$[58]!==A||$[59]!==j||$[60]!==B||$[61]!==V||$[62]!==K||$[63]!==G||$[64]!==z?(Y=(0,r.jsxs)(s.UC,{className:G,style:z,onOpenAutoFocus:A,onCloseAutoFocus:S,onEscapeKeyDown:N,onPointerDownCapture:j,onInteractOutside:C,tabIndex:-1,children:[B,t,V,K]}),$[54]=t,$[55]=S,$[56]=N,$[57]=C,$[58]=A,$[59]=j,$[60]=B,$[61]=V,$[62]=K,$[63]=G,$[64]=z,$[65]=Y):Y=$[65],$[66]!==k||$[67]!==Y||$[68]!==M?(H=(0,r.jsxs)(s.ZL,{container:k,children:[M,Y]}),$[66]=k,$[67]=Y,$[68]=M,$[69]=H):H=$[69],$[70]!==w||$[71]!==R||$[72]!==H||$[73]!==ea||$[74]!==F?(X=(0,r.jsxs)(s.bL,{modal:ea,open:w,...R,children:[F,H]}),$[70]=w,$[71]=R,$[72]=H,$[73]=ea,$[74]=F,$[75]=X):X=$[75],X}p.displayName="Drawer"},20396:(e,t,n)=>{n.d(t,{EN:()=>u,L7:()=>h,FX:()=>m,Qd:()=>f});var r=n(95155),a=n(19749),s=n(10083),l=n(21335),o=n(12115),i=n(91360);let c=(0,i.u)({item:(0,l.F)(["UI-Disclosure__item"]),contentContainer:(0,l.F)(["UI-Disclosure__contentContainer","overflow-hidden transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"]),content:(0,l.F)(["UI-Disclosure__content"])}),d=o.createContext({}),u=o.forwardRef((e,t)=>{let n,l,o,i,c,u,m,f=(0,a.c)(15);return f[0]!==e?({contentContainerClass:l,contentClass:n,itemClass:o,...i}=e,f[0]=e,f[1]=n,f[2]=l,f[3]=o,f[4]=i):(n=f[1],l=f[2],o=f[3],i=f[4]),f[5]!==n||f[6]!==l||f[7]!==o?(c={itemClass:o,contentContainerClass:l,contentClass:n},f[5]=n,f[6]=l,f[7]=o,f[8]=c):c=f[8],f[9]!==t||f[10]!==i?(u=(0,r.jsx)(s.bL,{ref:t,...i}),f[9]=t,f[10]=i,f[11]=u):u=f[11],f[12]!==c||f[13]!==u?(m=(0,r.jsx)(d.Provider,{value:c,children:u}),f[12]=c,f[13]=u,f[14]=m):m=f[14],m});u.displayName="Disclosure";let m=o.forwardRef((e,t)=>{let n,l,u,m,f=(0,a.c)(10);f[0]!==e?({className:n,...l}=e,f[0]=e,f[1]=n,f[2]=l):(n=f[1],l=f[2]);let{itemClass:h}=o.useContext(d);return f[3]!==n||f[4]!==h?(u=(0,i.cn)(c.item(),h,n),f[3]=n,f[4]=h,f[5]=u):u=f[5],f[6]!==t||f[7]!==l||f[8]!==u?(m=(0,r.jsx)(s.q7,{ref:t,className:u,...l}),f[6]=t,f[7]=l,f[8]=u,f[9]=m):m=f[9],m});m.displayName="DisclosureItem";let f=o.forwardRef((e,t)=>{let n,l=(0,a.c)(3);return l[0]!==e||l[1]!==t?(n=(0,r.jsx)(s.Y9,{asChild:!0,children:(0,r.jsx)(s.l9,{ref:t,asChild:!0,...e})}),l[0]=e,l[1]=t,l[2]=n):n=l[2],n});f.displayName="DisclosureTrigger";let h=o.forwardRef((e,t)=>{let n,l,u,m,f,h,x,p,g=(0,a.c)(19);g[0]!==e?({className:l,contentContainerClass:u,children:n,...m}=e,g[0]=e,g[1]=n,g[2]=l,g[3]=u,g[4]=m):(n=g[1],l=g[2],u=g[3],m=g[4]);let{contentContainerClass:v,contentClass:_}=o.useContext(d);return g[5]!==v||g[6]!==u?(f=(0,i.cn)(c.contentContainer(),v,u),g[5]=v,g[6]=u,g[7]=f):f=g[7],g[8]!==_||g[9]!==l?(h=(0,i.cn)(c.content(),_,l),g[8]=_,g[9]=l,g[10]=h):h=g[10],g[11]!==n||g[12]!==h?(x=(0,r.jsx)("div",{className:h,children:n}),g[11]=n,g[12]=h,g[13]=x):x=g[13],g[14]!==t||g[15]!==m||g[16]!==f||g[17]!==x?(p=(0,r.jsx)(s.UC,{ref:t,className:f,...m,children:x}),g[14]=t,g[15]=m,g[16]=f,g[17]=x,g[18]=p):p=g[18],p});h.displayName="DisclosureContent"},23862:(e,t,n)=>{n.d(t,{c:()=>r});let r=function(e){return e.ANILIST_DATA_LOADED="server-ready",e.SCAN_PROGRESS="scan-progress",e.SCAN_STATUS="scan-status",e.REFRESHED_ANILIST_ANIME_COLLECTION="refreshed-anilist-anime-collection",e.REFRESHED_ANILIST_MANGA_COLLECTION="refreshed-anilist-manga-collection",e.LIBRARY_WATCHER_FILE_ADDED="library-watcher-file-added",e.LIBRARY_WATCHER_FILE_REMOVED="library-watcher-file-removed",e.AUTO_DOWNLOADER_ITEM_ADDED="auto-downloader-item-added",e.AUTO_SCAN_STARTED="auto-scan-started",e.AUTO_SCAN_COMPLETED="auto-scan-completed",e.PLAYBACK_MANAGER_PROGRESS_TRACKING_STARTED="playback-manager-progress-tracking-started",e.PLAYBACK_MANAGER_PROGRESS_TRACKING_STOPPED="playback-manager-progress-tracking-stopped",e.PLAYBACK_MANAGER_PROGRESS_VIDEO_COMPLETED="playback-manager-progress-video-completed",e.PLAYBACK_MANAGER_PROGRESS_PLAYBACK_STATE="playback-manager-progress-playback-state",e.PLAYBACK_MANAGER_PROGRESS_UPDATED="playback-manager-progress-updated",e.PLAYBACK_MANAGER_PLAYLIST_STATE="playback-manager-playlist-state",e.PLAYBACK_MANAGER_MANUAL_TRACKING_PLAYBACK_STATE="playback-manager-manual-tracking-playback-state",e.EXTERNAL_PLAYER_OPEN_URL="external-player-open-url",e.PLAYBACK_MANAGER_MANUAL_TRACKING_STOPPED="playback-manager-manual-tracking-stopped",e.ERROR_TOAST="error-toast",e.SUCCESS_TOAST="success-toast",e.INFO_TOAST="info-toast",e.WARNING_TOAST="warning-toast",e.REFRESHED_MANGA_DOWNLOAD_DATA="refreshed-manga-download-data",e.CHAPTER_DOWNLOAD_QUEUE_UPDATED="chapter-download-queue-updated",e.OFFLINE_SNAPSHOT_CREATED="offline-snapshot-created",e.MEDIASTREAM_SHUTDOWN_STREAM="mediastream-shutdown-stream",e.EXTENSIONS_RELOADED="extensions-reloaded",e.EXTENSION_UPDATES_FOUND="extension-updates-found",e.PLUGIN_UNLOADED="plugin-unloaded",e.PLUGIN_LOADED="plugin-loaded",e.ACTIVE_TORRENT_COUNT_UPDATED="active-torrent-count-updated",e.SYNC_LOCAL_QUEUE_STATE="sync-local-queue-state",e.SYNC_LOCAL_FINISHED="sync-local-finished",e.SYNC_ANILIST_FINISHED="sync-anilist-finished",e.DEBRID_DOWNLOAD_PROGRESS="debrid-download-progress",e.DEBRID_STREAM_STATE="debrid-stream-state",e.CHECK_FOR_UPDATES="check-for-updates",e.INVALIDATE_QUERIES="invalidate-queries",e.CONSOLE_LOG="console-log",e.CONSOLE_WARN="console-warn",e}({})},28296:(e,t,n)=>{n.d(t,{O:()=>o});var r=n(95155),a=n(19749),s=n(10554);n(12115);var l=n(78453);function o(e){var t,n;let l,o,u,m,f,h,x,p=(0,a.c)(14),{updateData:g}=e,{data:v}=(0,s.G9)(null==g||null==(t=g.release)?void 0:t.version,null==g?void 0:g.current_version,!!(null==g||null==(n=g.release)?void 0:n.version)&&!!(null==g?void 0:g.current_version)),{body:_}=function(e){let t,n,r=(0,a.c)(7);e:{let n;if(!e||!e.release){let e;r[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],r[0]=e):e=r[0],t=e;break e}let a=e.release.body;if(a.includes("---")){let e;r[1]!==a?(e=a.split("---"),r[1]=a,r[2]=e):e=r[2],a=e[0]}r[3]!==a?(n=a.split(/\n/).filter(d),r[3]=a,r[4]=n):n=r[4],t=n}let s=t;return r[5]!==s?(n={body:s},r[5]=s,r[6]=n):n=r[6],n}(g);p[0]===Symbol.for("react.memo_cache_sentinel")?(l=function(e){let{lines:t}=e;return(0,r.jsx)(r.Fragment,{children:t.map(c)})},p[0]=l):l=p[0];let y=l;return p[1]!==_?(o=_.some(i)&&(0,r.jsx)("p",{className:"text-red-300 font-semibold flex gap-2 items-center",children:"This update includes a critical patch"}),p[1]=_,p[2]=o):o=p[2],p[3]===Symbol.for("react.memo_cache_sentinel")?(u=(0,r.jsx)("h5",{children:"What's new?"}),p[3]=u):u=p[3],p[4]!==_?(m=(0,r.jsxs)("div",{className:"rounded-[--radius] space-y-1",children:[u,(0,r.jsx)(y,{lines:_})]}),p[4]=_,p[5]=m):m=p[5],p[6]!==o||p[7]!==m?(f=(0,r.jsxs)("div",{className:"bg-gray-950/50 rounded-[--radius] p-4 max-h-[70vh] overflow-y-auto halo-2",children:[o,m]}),p[6]=o,p[7]=m,p[8]=f):f=p[8],p[9]!==v?(h=!!(null==v?void 0:v.length)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-center font-semibold",children:"Other updates you've missed"}),(0,r.jsx)("div",{className:"bg-gray-950/50 rounded-[--radius] p-4 max-h-[40vh] overflow-y-auto space-y-1.5",children:null==v?void 0:v.map(e=>(0,r.jsxs)("div",{className:"rounded-[--radius]",children:[(0,r.jsx)("p",{className:"text-center font-bold",children:e.version},e.version),(0,r.jsx)("div",{className:"text-sm",children:(0,r.jsx)(y,{lines:e.lines})})]},e.version))})]}),p[9]=v,p[10]=h):h=p[10],p[11]!==f||p[12]!==h?(x=(0,r.jsxs)(r.Fragment,{children:[f,h]}),p[11]=f,p[12]=h,p[13]=x):x=p[13],x}function i(e){return e.includes("\uD83D\uDE91️")}function c(e,t){return e.includes("\uD83D\uDE91️")?(0,r.jsxs)("p",{className:"text-red-300 font-semibold flex gap-2 items-center",children:[e,(0,r.jsx)(l.$S7,{})]},t):e.includes("\uD83C\uDF89")||e.includes("✨")?(0,r.jsx)("p",{className:"text-white",children:e},t):e.includes("⚡️")||e.includes("\uD83D\uDC84")||e.includes("\uD83E\uDDBA")||e.includes("⬆️")||e.includes("\uD83C\uDFD7️")||e.includes("\uD83D\uDE80")||e.includes("\uD83D\uDD27")||e.includes("\uD83D\uDD0D")||e.includes("\uD83D\uDD12")||e.includes("\uD83D\uDD11")||e.includes("\uD83D\uDD17")||e.includes("\uD83D\uDD28")||e.includes("\uD83C\uDFA8")||e.includes("\uD83D\uDCDD")||e.includes("♻️")||e.includes("\uD83D\uDD04")||e.includes("⏪️")||e.includes("\uD83E\uDE79")?(0,r.jsx)("p",{className:"",children:e},t):(0,r.jsxs)("p",{className:"opacity-75 pl-4 text-sm",children:[e,(0,r.jsx)("br",{})]},t)}function d(e){return""!==e.trim()&&e.trim().startsWith("-")}},39797:(e,t,n)=>{n.d(t,{m:()=>m});var r=n(95155),a=n(5249),s=n(21335),l=n(12115),o=n(91360),i=n(20396),c=n(97400);let d=(0,o.u)({root:(0,s.F)(["UI-VerticalMenu__root","flex flex-col gap-1"]),item:(0,s.F)(["UI-VerticalMenu__item","group/verticalMenu_item relative flex flex-none truncate items-center w-full font-medium rounded-[--radius] transition cursor-pointer","hover:bg-[--subtle] hover:text-[--foreground]","focus-visible:bg-[--subtle] outline-none text-[--muted]","data-[current=true]:bg-[--subtle] data-[current=true]:text-[--foreground]"],{variants:{collapsed:{true:"justify-center",false:null}},defaultVariants:{collapsed:!1}}),itemContent:(0,s.F)(["UI-VerticalMenu__itemContent","w-full flex items-center relative"],{variants:{size:{sm:"px-3 h-8 text-sm",md:"px-3 h-10 text-sm",lg:"px-3 h-12 text-base"},collapsed:{true:"justify-center",false:null}},defaultVariants:{size:"md",collapsed:!1}}),parentItem:(0,s.F)(["UI-VerticalMenu__parentItem","group/verticalMenu_parentItem","cursor-pointer w-full"]),itemChevron:(0,s.F)(["UI-VerticalMenu__itemChevron","size-4 absolute transition-transform group-data-[state=open]/verticalMenu_parentItem:rotate-90"],{variants:{size:{sm:"right-3",md:"right-3",lg:"right-3"},collapsed:{true:"top-1 left-1 size-3",false:null}},defaultVariants:{size:"md",collapsed:!1}}),itemIcon:(0,s.F)(["UI-VerticalMenu__itemIcon","flex-shrink-0 mr-3","text-[--muted] text-xl","group-hover/verticalMenu_item:text-[--foreground]","group-data-[current=true]/verticalMenu_item:text-[--foreground]"],{variants:{size:{sm:"size-4",md:"size-5",lg:"size-6"},collapsed:{true:"mr-0",false:null}},defaultVariants:{size:"md"}}),subContent:(0,s.F)(["UI-VerticalMenu__subContent","border-b py-1"])}),u=l.createContext({}),m=l.forwardRef((e,t)=>{var n;let{children:s,size:m="md",collapsed:f,onAnyItemClick:h,onLinkItemClick:x,itemClass:p,itemIconClass:g,parentItemClass:v,subContentClass:_,itemChevronClass:y,itemContentClass:b,itemTooltipProps:E,className:S,items:N,...C}=e,{onLinkItemClick:A,onAnyItemClick:j,collapsed:w}=(0,l.useContext)(u),D=null!=(n=null!=f?f:w)&&n,k=e=>({className:(0,o.cn)(d.item({collapsed:D}),p),"data-current":e.isCurrent,onClick:t=>{var n;e.href&&(null==x||x(t),null==A||A(t)),null==h||h(t),null==j||j(t),null==(n=e.onClick)||n.call(e,t)}}),R=l.useCallback(e=>D?(0,r.jsx)(c.m_,{trigger:e.children,side:"right",...E,children:e.name}):e.children,[D,E]),I=l.useCallback(e=>(0,r.jsx)(R,{name:e.name,children:(0,r.jsxs)("div",{"data-vertical-menu-item":e.name,className:(0,o.cn)(d.itemContent({size:m,collapsed:D}),b),children:[e.iconType&&(0,r.jsx)(e.iconType,{className:(0,o.cn)(d.itemIcon({size:m,collapsed:D}),g),"aria-hidden":"true","data-current":e.isCurrent}),!D&&(0,r.jsx)("span",{children:e.name}),e.addon]})}),[D,m,b,g]);return(0,r.jsx)("nav",{ref:t,className:(0,o.cn)(d.root(),S),role:"navigation",...C,children:(0,r.jsx)(u.Provider,{value:{onAnyItemClick:h,onLinkItemClick:x,collapsed:null!=f&&f},children:N.map((e,t)=>(0,r.jsx)(l.Fragment,{children:e.subContent?(0,r.jsx)(i.EN,{type:"multiple",children:(0,r.jsxs)(i.FX,{value:e.name,children:[(0,r.jsx)(i.Qd,{children:(0,r.jsxs)("button",{className:(0,o.cn)(d.item({collapsed:D}),p,d.parentItem(),v),"aria-current":e.isCurrent?"page":void 0,"data-current":e.isCurrent,onClick:e.onClick,children:[(0,r.jsx)(I,{...e}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,o.cn)(d.itemChevron({size:m,collapsed:D}),y),children:(0,r.jsx)("polyline",{points:"9 18 15 12 9 6"})})]})}),(0,r.jsx)(i.L7,{className:(0,o.cn)(d.subContent(),_),children:e.subContent&&e.subContent})]})}):e.href?(0,r.jsx)(a.i,{href:e.href,...k(e),"data-vertical-menu-item-link":e.name,children:(0,r.jsx)(I,{...e})}):(0,r.jsx)("button",{...k(e),"data-vertical-menu-item-button":e.name,children:(0,r.jsx)(I,{...e})})},e.name+t))})})});m.displayName="VerticalMenu"},50558:(e,t,n)=>{n.d(t,{F:()=>c});var r=n(95155),a=n(19749),s=n(21335),l=n(12115),o=n(91360);let i=(0,o.u)({root:(0,s.F)(["UI-Alert__root","py-3 px-4 flex justify-between rounded-[--radius]"],{variants:{intent:{info:"bg-blue-50 text-blue-500 dark:bg-opacity-10 dark:text-blue-200",success:"bg-green-50 text-green-500 dark:bg-opacity-10 dark:text-green-200",warning:"bg-orange-50 text-orange-500 dark:bg-opacity-10 dark:text-orange-200",alert:"bg-red-50 text-red-500 dark:bg-opacity-10 dark:text-red-200","info-basic":"bg-white text-gray-800 border dark:bg-gray-800 dark:text-gray-200","success-basic":"bg-white text-gray-800 border dark:bg-gray-800 dark:text-gray-200","warning-basic":"bg-white text-gray-800 border dark:bg-gray-800 dark:text-gray-200","alert-basic":"bg-white text-gray-800 border dark:bg-gray-800 dark:text-gray-200"}},defaultVariants:{intent:"info"}}),detailsContainer:(0,s.F)(["UI-Alert__detailsContainer","flex"]),textContainer:(0,s.F)(["UI-Alert__textContainer","flex flex-col self-center ml-3 gap-.5"]),title:(0,s.F)(["UI-Alert__title","font-bold"]),description:(0,s.F)(["UI-Alert__description"]),icon:(0,s.F)(["UI-Alert__icon","text-2xl content-evenly"],{variants:{intent:{"info-basic":"text-blue-500","success-basic":"text-green-500","warning-basic":"text-orange-500","alert-basic":"text-red-500",info:"text-blue-500",success:"text-green-500",warning:"text-orange-500",alert:"text-red-500"}},defaultVariants:{intent:"info-basic"}}),closeButton:(0,s.F)(["UI-Alert__closeButton","flex-none self-start text-2xl hover:opacity-50 transition ease-in cursor-pointer h-5 w-5"])}),c=l.forwardRef((e,t)=>{let n,s,l,c,d,u,m,f,h,x,p,g,v,_,y,b,E,S,N,C,A,j,w,D,k,R=(0,a.c)(57);if(R[0]!==e){let{children:t,className:r,title:a,description:o,isClosable:i,onClose:y,intent:b,iconClass:E,detailsContainerClass:S,textContainerClass:N,titleClass:C,descriptionClass:A,closeButtonClass:j,icon:w,...D}=e;n=t,s=r,v=a,c=o,h=y,p=b,f=E,u=S,g=N,_=C,d=A,l=j,m=w,x=D,R[0]=e,R[1]=n,R[2]=s,R[3]=l,R[4]=c,R[5]=d,R[6]=u,R[7]=m,R[8]=f,R[9]=h,R[10]=x,R[11]=p,R[12]=g,R[13]=v,R[14]=_}else n=R[1],s=R[2],l=R[3],c=R[4],d=R[5],u=R[6],m=R[7],f=R[8],h=R[9],x=R[10],p=R[11],g=R[12],v=R[13],_=R[14];let I=void 0===p?"info-basic":p,L=null;if("info-basic"===I||"info"===I){let e;R[15]===Symbol.for("react.memo_cache_sentinel")?(e=(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"M12 16v-4"}),(0,r.jsx)("path",{d:"M12 8h.01"})]}),R[15]=e):e=R[15],L=e}else if("alert-basic"===I||"alert"===I){let e;R[16]===Symbol.for("react.memo_cache_sentinel")?(e=(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",x2:"12",y1:"8",y2:"12"}),(0,r.jsx)("line",{x1:"12",x2:"12.01",y1:"16",y2:"16"})]}),R[16]=e):e=R[16],L=e}else if("warning-basic"===I||"warning"===I){let e;R[17]===Symbol.for("react.memo_cache_sentinel")?(e=(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),(0,r.jsx)("line",{x1:"12",x2:"12",y1:"9",y2:"13"}),(0,r.jsx)("line",{x1:"12",x2:"12.01",y1:"17",y2:"17"})]}),R[17]=e):e=R[17],L=e}else if("success-basic"===I||"success"===I){let e;R[18]===Symbol.for("react.memo_cache_sentinel")?(e=(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),(0,r.jsx)("path",{d:"m9 12 2 2 4-4"})]}),R[18]=e):e=R[18],L=e}return R[19]!==s||R[20]!==I?(y=(0,o.cn)(i.root({intent:I}),s),R[19]=s,R[20]=I,R[21]=y):y=R[21],R[22]!==u?(b=(0,o.cn)(i.detailsContainer(),u),R[22]=u,R[23]=b):b=R[23],R[24]!==L||R[25]!==m||R[26]!==f||R[27]!==I?(E=m||(0,r.jsx)("div",{className:(0,o.cn)(i.icon({intent:I}),f),children:L&&L}),R[24]=L,R[25]=m,R[26]=f,R[27]=I,R[28]=E):E=R[28],R[29]!==g?(S=(0,o.cn)(i.textContainer(),g),R[29]=g,R[30]=S):S=R[30],R[31]!==_?(N=(0,o.cn)(i.title(),_),R[31]=_,R[32]=N):N=R[32],R[33]!==N||R[34]!==v?(C=(0,r.jsx)("span",{className:N,children:v}),R[33]=N,R[34]=v,R[35]=C):C=R[35],R[36]!==n||R[37]!==c||R[38]!==d?(A=!!(c||n)&&(0,r.jsx)("div",{className:(0,o.cn)(i.description(),d),children:c||n}),R[36]=n,R[37]=c,R[38]=d,R[39]=A):A=R[39],R[40]!==S||R[41]!==C||R[42]!==A?(j=(0,r.jsxs)("div",{className:S,children:[C,A]}),R[40]=S,R[41]=C,R[42]=A,R[43]=j):j=R[43],R[44]!==b||R[45]!==E||R[46]!==j?(w=(0,r.jsxs)("div",{className:b,children:[E,j]}),R[44]=b,R[45]=E,R[46]=j,R[47]=w):w=R[47],R[48]!==l||R[49]!==h?(D=h&&(0,r.jsx)("button",{className:(0,o.cn)(i.closeButton(),l),onClick:h,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})}),R[48]=l,R[49]=h,R[50]=D):D=R[50],R[51]!==t||R[52]!==x||R[53]!==y||R[54]!==D||R[55]!==w?(k=(0,r.jsxs)("div",{className:y,...x,ref:t,children:[w,D]}),R[51]=t,R[52]=x,R[53]=y,R[54]=D,R[55]=w,R[56]=k):k=R[56],k});c.displayName="Alert"},73826:(e,t,n)=>{n.d(t,{$R:()=>I,O1:()=>R,ST:()=>D,kP:()=>k});var r=n(95155),a=n(45886),s=n(4022),l=n(19749),o=n(6759),i=n(78106),c=n(84127),d=n(2091),u=n(76049),m=n(28382),f=n(15821),h=n(29724),x=n(12115),p=n(69554);function g(){let e,t,n,a,s,g,b,E,S,N,C,A,j,w,R=(0,l.c)(29),[I,L]=x.useState(!1),[T]=(0,h.fp)(D),O=(0,h.md)(k),[U,P]=x.useState(!1),F=(0,h.md)(o.fw),W=(0,h.md)(o.cu);R[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{"main"===(0,f.Z3)().label&&L(!0)},t=[],R[0]=e,R[1]=t):(e=R[0],t=R[1]),x.useEffect(e,t),R[2]===Symbol.for("react.memo_cache_sentinel")?(n=async()=>{P(!0),p.oR.info("Restarting server..."),(0,m.Ic)("restart-server").catch(y).then(_),x.startTransition(()=>{setTimeout(()=>{P(!1)},5e3)})},R[2]=n):n=R[2];let M=n,G=x.useRef(!0);if(R[3]!==O||R[4]!==T||R[5]!==F?(a=()=>{!T&&O>=10&&G.current&&!F&&(G.current=!1,console.log("Connection error count reached 10, restarting server automatically"),M())},R[3]=O,R[4]=T,R[5]=F,R[6]=a):a=R[6],R[7]!==O?(s=[O],R[7]=O,R[8]=s):s=R[8],x.useEffect(a,s),R[9]!==T?(g=()=>{T&&(P(!1),G.current=!0)},b=[T],R[9]=T,R[10]=g,R[11]=b):(g=R[10],b=R[11]),x.useEffect(g,b),!I)return null;R[12]!==O||R[13]!==T||R[14]!==F||R[15]!==W?(E=!T&&O<10&&!W&&!F&&(0,r.jsx)(d.p8,{className:"fixed left-0 top-0 z-[9999]",children:(0,r.jsx)("p",{children:"The server connection has been lost. Please wait while we attempt to reconnect."})}),R[12]=O,R[13]=T,R[14]=F,R[15]=W,R[16]=E):E=R[16];let z=!T&&O>=10&&!F;return R[17]===Symbol.for("react.memo_cache_sentinel")?(S=(0,r.jsx)("p",{className:"text-lg max-w-sm",children:"The background server process has stopped responding. Please restart it to continue."}),R[17]=S):S=R[17],R[18]!==U?(N=(0,r.jsx)(c.$n,{onClick:M,loading:U,intent:"white-outline",size:"lg",className:"rounded-full",children:"Restart server"}),R[18]=U,R[19]=N):N=R[19],R[20]===Symbol.for("react.memo_cache_sentinel")?(C=(0,r.jsx)("p",{className:"text-[--muted] text-sm max-w-xl",children:"If this message persists after multiple tries, please relaunch the application."}),R[20]=C):C=R[20],R[21]!==N?(A=(0,r.jsx)(i.D,{children:(0,r.jsxs)("div",{className:"space-y-4 flex flex-col items-center",children:[S,N,C]})}),R[21]=N,R[22]=A):A=R[22],R[23]!==A||R[24]!==z?(j=(0,r.jsx)(u.a,{open:z,onOpenChange:v,hideCloseButton:!0,contentClass:"max-w-2xl",children:A}),R[23]=A,R[24]=z,R[25]=j):j=R[25],R[26]!==j||R[27]!==E?(w=(0,r.jsxs)(r.Fragment,{children:[E,j]}),R[26]=j,R[27]=E,R[28]=w):w=R[28],w}function v(){}function _(){console.log("Successfully emitted restart-server event")}function y(e){console.log("Failed to emit restart-server event:",e)}var b=n(15388),E=n(93715),S=n(42500),N=n(89864),C=n(43994),A=n(49927),j=n(42463),w=n(38310);let D=(0,S.eU)(!1),k=(0,S.eU)(0),R=(0,S.eU)(null);function I(e){let{children:t}=e,[n,l]=(0,h.fp)(s.R),[o,i]=(0,h.fp)(D),c=(0,h.Xr)(k),d=(0,h.md)(b.EQ),[u,m,f]=(0,N.lT)(["Seanime-Client-Id"]),[,p]=(0,h.fp)(R),v=x.useRef(null),_=x.useRef(null),y=x.useRef(null),S=x.useRef(Date.now()),I=x.useRef(null);return x.useRef(!1),x.useRef(!0),x.useEffect(()=>{(0,E.v)("WebsocketProvider").info("Seanime-Client-Id",u["Seanime-Client-Id"]),u["Seanime-Client-Id"]&&p(u["Seanime-Client-Id"])},[u]),(0,j.A)(()=>{function e(){v.current&&(clearInterval(v.current),v.current=null),_.current&&(clearInterval(_.current),_.current=null),y.current&&(clearTimeout(y.current),y.current=null)}function t(){if(e(),I.current&&I.current.readyState!==WebSocket.CLOSED)try{I.current.close()}catch(e){}let t="".concat("https:"==document.location.protocol?"wss":"ws","://").concat((0,a.M)(!0),"/events"),n=u["Seanime-Client-Id"]||"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16));try{var o,d,f;I.current=new WebSocket("".concat(t,"?id=").concat(n)),S.current=Date.now(),I.current.addEventListener("open",()=>{(0,E.v)("WebsocketProvider").info("WebSocket connection opened"),i(!0),c(0),u["Seanime-Client-Id"]||m("Seanime-Client-Id",n,{path:"/",sameSite:"lax",secure:!1,maxAge:86400}),v.current=setInterval(()=>{var e;let t=Date.now()-S.current;if(t>45e3){(0,E.v)("WebsocketProvider").error("No pong response for ".concat(Math.round(t/1e3),"s, reconnecting")),s();return}(null==(e=I.current)?void 0:e.readyState)!==WebSocket.OPEN&&((0,E.v)("WebsocketProvider").error("Heartbeat check failed, reconnecting"),s())},15e3),setTimeout(()=>{_.current=setInterval(()=>{var e,t,r;if((null==(e=I.current)?void 0:e.readyState)===WebSocket.OPEN)try{let e=Date.now();null==(t=I.current)||t.send(JSON.stringify({type:"ping",payload:{timestamp:e},clientId:n}))}catch(e){(0,E.v)("WebsocketProvider").error("Failed to send ping",e),s()}else(0,E.v)("WebsocketProvider").error("Failed to send ping, WebSocket not open",null==(r=I.current)?void 0:r.readyState)},15e3)},5e3)}),null==(o=I.current)||o.addEventListener("message",e=>{try{let t=JSON.parse(e.data);"pong"===t.type&&(S.current=Date.now())}catch(e){}}),null==(d=I.current)||d.addEventListener("close",e=>{(0,E.v)("WebsocketProvider").info("WebSocket connection closed: ".concat(e.code," ").concat(e.reason)),r()}),null==(f=I.current)||f.addEventListener("error",e=>{(0,E.v)("WebsocketProvider").error("WebSocket encountered an error:",e),s()}),l(I.current)}catch(e){(0,E.v)("WebsocketProvider").error("Failed to create WebSocket connection:",e),r()}}function r(){e(),i(!1),c(e=>{let n=e+1,r=Math.min(1e3*Math.pow(2,Math.min(n-1,10)),3e3);return(0,E.v)("WebsocketProvider").info("Reconnecting in ".concat(r,"ms (attempt ").concat(n,")")),y.current=setTimeout(()=>{t()},r),n})}function s(){if(I.current)try{I.current.close()}catch(e){}r()}return n&&n.readyState!==WebSocket.CLOSED||t(),()=>{if(I.current)try{I.current.close()}catch(e){}i(!1),e()}}),(0,r.jsxs)(r.Fragment,{children:[d.length>0&&(0,r.jsx)(A.jp,{}),"desktop"===w.env.NEXT_PUBLIC_PLATFORM&&(0,r.jsx)(g,{}),(0,r.jsxs)(s.P.Provider,{value:n,children:[!o&&(0,r.jsxs)("div",{className:"fixed right-4 bottom-4 bg-gray-900 border text-[--muted] text-sm py-3 px-5 font-semibold rounded-[--radius-md] z-[100] flex gap-2 items-center",children:[(0,r.jsx)(C.Boc,{className:"text-brand-200 animate-spin text-lg"}),"Establishing connection..."]}),t]})]})}},78106:(e,t,n)=>{n.d(t,{D:()=>c});var r=n(95155),a=n(19749),s=n(81655),l=n(91360),o=n(35089),i=n(6066);n(12115);let c=e=>{let t,n,c,d,u,m,f,h,x,p=(0,a.c)(23),{children:g,reset:v,className:_,title:y,showRefreshButton:b}=e,E=void 0===y?"Oops!":y,S=void 0!==b&&b,N=(0,i.useRouter)();return p[0]!==_?(t=(0,l.cn)("w-full flex flex-col items-center mt-10 space-y-4",_),p[0]=_,p[1]=t):t=p[1],p[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsx)("div",{"data-luffy-error-image-container":!0,className:"size-[8rem] mx-auto flex-none rounded-[--radius-md] object-cover object-center relative overflow-hidden",children:(0,r.jsx)(o.default,{"data-luffy-error-image":!0,src:"/luffy-01.png",alt:"",fill:!0,quality:100,priority:!0,sizes:"10rem",className:"object-contain object-top"})}),p[2]=n):n=p[2],p[3]!==E?(c=!!E&&(0,r.jsx)("h3",{"data-luffy-error-title":!0,children:E}),p[3]=E,p[4]=c):c=p[4],p[5]!==g?(d=(0,r.jsx)("div",{"data-luffy-error-content-children":!0,children:g}),p[5]=g,p[6]=d):d=p[6],p[7]!==v||p[8]!==N||p[9]!==S?(u=S&&!v&&(0,r.jsx)(s.$,{"data-luffy-error-content-button-refresh":!0,intent:"warning-subtle",onClick:()=>N.refresh(),children:"Retry"}),p[7]=v,p[8]=N,p[9]=S,p[10]=u):u=p[10],p[11]!==v?(m=!!v&&(0,r.jsx)(s.$,{"data-luffy-error-content-button-reset":!0,intent:"warning-subtle",onClick:v,children:"Retry"}),p[11]=v,p[12]=m):m=p[12],p[13]!==u||p[14]!==m?(f=(0,r.jsxs)("div",{"data-luffy-error-content-buttons":!0,children:[u,m]}),p[13]=u,p[14]=m,p[15]=f):f=p[15],p[16]!==c||p[17]!==d||p[18]!==f?(h=(0,r.jsxs)("div",{"data-luffy-error-content":!0,className:"text-center space-y-4",children:[c,d,f]}),p[16]=c,p[17]=d,p[18]=f,p[19]=h):h=p[19],p[20]!==t||p[21]!==h?(x=(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{"data-luffy-error":!0,className:t,children:[n,h]})}),p[20]=t,p[21]=h,p[22]=x):x=p[22],x}},93715:(e,t,n)=>{n.d(t,{v:()=>r});let r=e=>({info:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];console.log("[".concat(e,"]")+" ",...n)},warning:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];console.log("[".concat(e,"]")+" ",...n)},success:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];console.log("[".concat(e,"]")+" ",...n)},error:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];console.log("[".concat(e,"]")+" ",...n)}})}}]);