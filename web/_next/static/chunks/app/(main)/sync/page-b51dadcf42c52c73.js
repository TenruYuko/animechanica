(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1555],{39331:(e,l,n)=>{Promise.resolve().then(n.bind(n,88805))},88805:(e,l,n)=>{"use strict";n.r(l),n.d(l,{default:()=>M,dynamic:()=>U});var a=n(95155),i=n(19749),s=n(87403),t=n(36945),d=n(61585),r=n(14490),c=n(37817),o=n(38900),m=n(75006),u=n(75733),h=n(35656),x=n(84127),g=n(91360),p=n(76049),f=n(29724),j=n(35089),v=n(12115),y=n(41452);function b(e){let l,n,t,d,r,c,o,m=(0,i.c)(15),{savedMediaIds:u}=e;m[0]===Symbol.for("react.memo_cache_sentinel")?(l=[],m[0]=l):l=m[0];let[h,g]=v.useState(l),{mutate:f,isPending:j}=(0,s.IE)();m[1]!==f||m[2]!==h?(n=function(){f({media:h},{onSuccess:()=>{g([])}})},m[1]=f,m[2]=h,m[3]=n):n=m[3];let b=n;return m[4]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)(y.Qpb,{className:"text-2xl"}),m[4]=t):t=m[4],m[5]!==j?(d=(0,a.jsx)(x.$n,{intent:"success-subtle",rounded:!0,leftIcon:t,loading:j,children:"Save media"}),m[5]=j,m[6]=d):d=m[6],m[7]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)("p",{className:"text-[--muted]",children:"Select the media you want to save locally. Click on already saved media to remove it from local storage."}),m[7]=r):r=m[7],m[8]!==b||m[9]!==u||m[10]!==h?(c=(0,a.jsx)(N,{selectedMedia:h,setSelectedMedia:g,savedMediaIds:u,onSave:b}),m[8]=b,m[9]=u,m[10]=h,m[11]=c):c=m[11],m[12]!==d||m[13]!==c?(o=(0,a.jsxs)(p.a,{title:"Saved media",contentClass:"max-w-4xl",trigger:d,children:[r,c]}),m[12]=d,m[13]=c,m[14]=o):o=m[14],o}function N(e){let l,n,t,d,r,c,u,h,g=(0,i.c)(27),{savedMediaIds:p,selectedMedia:j,setSelectedMedia:v,onSave:b}=e,N=(0,f.md)(m.Z),{data:P}=(0,o.QJ)(),{mutate:C,isPending:E}=(0,s.ZM)();g[0]!==v?(l=function(e){v(l=>l.find(l=>l.mediaId===e)?l.filter(l=>l.mediaId!==e):[...l,{mediaId:e,type:"anime"}])},g[0]=v,g[1]=l):l=g[1];let _=l;g[2]!==v?(n=function(e){v(l=>l.find(l=>l.mediaId===e)?l.filter(l=>l.mediaId!==e):[...l,{mediaId:e,type:"manga"}])},g[2]=v,g[3]=n):n=g[3];let k=n;g[4]===Symbol.for("react.memo_cache_sentinel")?(t=(0,a.jsx)("div",{className:"flex flex-1"}),g[4]=t):t=g[4];let w=0===j.length;return g[5]===Symbol.for("react.memo_cache_sentinel")?(d=(0,a.jsx)(y.Qpb,{className:"text-2xl"}),g[5]=d):d=g[5],g[6]!==b||g[7]!==w?(r=(0,a.jsxs)("div",{className:"flex items-center",children:[t,(0,a.jsx)(x.$n,{intent:"white",onClick:b,disabled:w,rounded:!0,leftIcon:d,children:"Save locally"})]}),g[6]=b,g[7]=w,g[8]=r):r=g[8],g[9]!==N||g[10]!==_||g[11]!==E||g[12]!==C||g[13]!==p||g[14]!==j?(c=N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"text-center",children:"Anime"}),(0,a.jsx)(I,{collection:N,entry:e=>(0,a.jsx)(S,{entry:e,onClick:()=>_(e.mediaId),isSelected:!!j.find(l=>l.mediaId===e.mediaId),isSaved:p.includes(e.mediaId),onUntrack:()=>{C({mediaId:e.mediaId,type:"anime"})},isPending:E})})]}),g[9]=N,g[10]=_,g[11]=E,g[12]=C,g[13]=p,g[14]=j,g[15]=c):c=g[15],g[16]!==k||g[17]!==E||g[18]!==P||g[19]!==C||g[20]!==p||g[21]!==j?(u=P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"text-center",children:"Manga"}),(0,a.jsx)(I,{collection:P,entry:e=>(0,a.jsx)(S,{entry:e,onClick:()=>k(e.mediaId),isSelected:!!j.find(l=>l.mediaId===e.mediaId),isSaved:p.includes(e.mediaId),onUntrack:()=>{C({mediaId:e.mediaId,type:"manga"})},isPending:E})})]}),g[16]=k,g[17]=E,g[18]=P,g[19]=C,g[20]=p,g[21]=j,g[22]=u):u=g[22],g[23]!==r||g[24]!==c||g[25]!==u?(h=(0,a.jsxs)("div",{className:"space-y-4",children:[r,c,u]}),g[23]=r,g[24]=c,g[25]=u,g[26]=h):h=g[26],h}function I(e){let{collection:l,entry:n}=e,i=v.useMemo(()=>{var e,n,a,i,s,t,d,r,c,o,m,u,h,x,g,p,f,j,v,y,b,N,I,S,P;return{CURRENT:null!=(b=null==(i=l.lists)||null==(a=i.find(e=>"CURRENT"===e.type))||null==(n=a.entries)||null==(e=n.filter(Boolean))?void 0:e.toSorted((e,l)=>e.media.title.userPreferred.localeCompare(l.media.title.userPreferred)))?b:[],PLANNING:null!=(N=null==(r=l.lists)||null==(d=r.find(e=>"PLANNING"===e.type))||null==(t=d.entries)||null==(s=t.filter(Boolean))?void 0:s.toSorted((e,l)=>e.media.title.userPreferred.localeCompare(l.media.title.userPreferred)))?N:[],COMPLETED:null!=(I=null==(u=l.lists)||null==(m=u.find(e=>"COMPLETED"===e.type))||null==(o=m.entries)||null==(c=o.filter(Boolean))?void 0:c.toSorted((e,l)=>e.media.title.userPreferred.localeCompare(l.media.title.userPreferred)))?I:[],PAUSED:null!=(S=null==(p=l.lists)||null==(g=p.find(e=>"PAUSED"===e.type))||null==(x=g.entries)||null==(h=x.filter(Boolean))?void 0:h.toSorted((e,l)=>e.media.title.userPreferred.localeCompare(l.media.title.userPreferred)))?S:[],DROPPED:null!=(P=null==(y=l.lists)||null==(v=y.find(e=>"DROPPED"===e.type))||null==(j=v.entries)||null==(f=j.filter(Boolean))?void 0:f.toSorted((e,l)=>e.media.title.userPreferred.localeCompare(l.media.title.userPreferred)))?P:[]}},[l]);return(0,a.jsxs)(a.Fragment,{children:[!!i.CURRENT.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{className:"border-b pb-1 mb-1",children:"Current"}),(0,a.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:i.CURRENT.map(e=>(0,a.jsx)(v.Fragment,{children:n(e)},e.mediaId))})]}),!!i.PAUSED.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{className:"border-b pb-1 mb-1",children:"Paused"}),(0,a.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:i.PAUSED.map(e=>(0,a.jsx)(v.Fragment,{children:n(e)},e.mediaId))})]}),!!i.PLANNING.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{className:"border-b pb-1 mb-1",children:"Planning"}),(0,a.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:i.PLANNING.map(e=>(0,a.jsx)(v.Fragment,{children:n(e)},e.mediaId))})]}),!!i.COMPLETED.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{className:"border-b pb-1 mb-1",children:"Completed"}),(0,a.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:i.COMPLETED.map(e=>(0,a.jsx)(v.Fragment,{children:n(e)},e.mediaId))})]}),!!i.DROPPED.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{className:"border-b pb-1 mb-1",children:"Dropped"}),(0,a.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2",children:i.DROPPED.map(e=>(0,a.jsx)(v.Fragment,{children:n(e)},e.mediaId))})]})]})}function S(e){var l,n,s,t,d,r,c;let o,m,x,p,f,v,y,b,N,I,S,P,C,E,_=(0,i.c)(38),{entry:k,onClick:w,isSelected:D,isSaved:A,onUntrack:F,isPending:L}=e;_[0]!==F?(o={title:"Remove offline data",description:"This action will remove the offline data for this media entry. Are you sure you want to proceed?",onConfirm:()=>{F()}},_[0]=F,_[1]=o):o=_[1];let T=(0,u.J)(o),U=k.mediaId,M=A&&"",O=L&&"pointer-events-none";_[2]!==M||_[3]!==O?(m=(0,g.cn)("col-span-1 aspect-[6/7] rounded-[--radius-md] overflow-hidden relative bg-[var(--background)] cursor-pointer transition-opacity select-none",M,O),_[2]=M,_[3]=O,_[4]=m):m=_[4],_[5]!==T||_[6]!==L||_[7]!==A||_[8]!==w?(x=()=>{L||(A?T.open():w())},_[5]=T,_[6]=L,_[7]=A,_[8]=w,_[9]=x):x=_[9];let R=(null==(n=k.media)||null==(l=n.coverImage)?void 0:l.large)||(null==(s=k.media)?void 0:s.bannerImage)||"";_[10]===Symbol.for("react.memo_cache_sentinel")?(p=(0,h.r)(700,475),_[10]=p):p=_[10];let $=D?"opacity-100":"opacity-60";_[11]!==$?(f=(0,g.cn)("object-center object-cover rounded-[--radius-md] transition-opacity",$),_[11]=$,_[12]=f):f=_[12],_[13]!==R||_[14]!==f?(v=(0,a.jsx)(j.default,{src:R,placeholder:p,sizes:"10rem",fill:!0,alt:"",className:f}),_[13]=R,_[14]=f,_[15]=v):v=_[15];let z=A&&"text-[--green]";_[16]!==z?(y=(0,g.cn)("line-clamp-2 text-sm absolute m-2 bottom-0 font-semibold z-[10]",z),_[16]=z,_[17]=y):y=_[17];let B=(null==(d=k.media)||null==(t=d.title)?void 0:t.userPreferred)||(null==(c=k.media)||null==(r=c.title)?void 0:r.romaji);_[18]!==y||_[19]!==B?(b=(0,a.jsx)("p",{className:y,children:B}),_[18]=y,_[19]=B,_[20]=b):b=_[20],_[21]===Symbol.for("react.memo_cache_sentinel")?(N=(0,a.jsx)("div",{className:"z-[5] absolute bottom-0 w-full h-[80%] bg-gradient-to-t from-[--background] to-transparent"}),_[21]=N):N=_[21];let Q=D?"opacity-0":"opacity-100 hover:opacity-80";return _[22]!==Q?(I=(0,g.cn)("z-[5] absolute top-0 w-full h-[80%] bg-gradient-to-b from-[--background] to-transparent transition-opacity",Q),_[22]=Q,_[23]=I):I=_[23],_[24]!==I?(S=(0,a.jsx)("div",{className:I}),_[24]=I,_[25]=S):S=_[25],_[26]!==k.mediaId||_[27]!==v||_[28]!==b||_[29]!==S||_[30]!==m||_[31]!==x?(P=(0,a.jsxs)("div",{className:m,onClick:x,children:[v,b,N,S]},U),_[26]=k.mediaId,_[27]=v,_[28]=b,_[29]=S,_[30]=m,_[31]=x,_[32]=P):P=_[32],_[33]!==T?(C=(0,a.jsx)(u.K,{...T}),_[33]=T,_[34]=C):C=_[34],_[35]!==P||_[36]!==C?(E=(0,a.jsxs)(a.Fragment,{children:[P,C]}),_[35]=P,_[36]=C,_[37]=E):E=_[37],E}var P=n(78106),C=n(45754),E=n(50558),_=n(63717),k=n(2091),w=n(98836),D=n(99288),A=n(23862),F=n(43994),L=n(64685),T=n(69554);let U="force-static";function M(){var e,l,n;let i=(0,c.v1)(),[o,m]=v.useState(!1),{data:u,isLoading:h}=(0,s.b$)(),{mutate:f,isPending:j}=(0,s.Wd)(),{mutate:y,isPending:N}=(0,s.tZ)(),{data:I}=(0,s.H8)(),{mutate:S,isPending:_}=(0,s.zQ)(),{data:U}=(0,s.i_)(),M=v.useMemo(()=>{var e;return null!=(e=null==u?void 0:u.filter(e=>{var l;return"anime"===e.type&&!!(null==(l=e.animeEntry)?void 0:l.media)}))?e:[]},[u]),R=v.useMemo(()=>{var e;return null!=(e=null==u?void 0:u.filter(e=>{var l;return"manga"===e.type&&!!(null==(l=e.mangaEntry)?void 0:l.media)}))?e:[]},[u]),[$,z]=v.useState(null);function B(){f(void 0,{onSuccess:()=>{m(!1)}})}function Q(){y(void 0,{onSuccess:()=>{m(!1)}})}return((0,r.oA)({type:A.c.SYNC_LOCAL_QUEUE_STATE,onMessage:e=>{z(e)}}),h)?(0,a.jsx)(k.kt,{}):(0,a.jsxs)(C.f,{className:"p-4 sm:p-8 pt-4 relative space-y-8",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-center lg:text-left",children:"Synced media"}),(0,a.jsx)("p",{className:"text-[--muted]",children:"View the media you've saved locally for offline use."})]}),(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsxs)("div",{className:"contents",children:[(0,a.jsx)(p.a,{title:"Sync",open:o,onOpenChange:e=>{if(!j)return m(e)},trigger:(0,a.jsx)(x.$n,{intent:"white",rounded:!0,leftIcon:(0,a.jsx)(F.Z05,{className:"text-2xl"}),loading:j,children:"Sync now"}),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(x.$n,{intent:"white",rounded:!0,className:"w-full",leftIcon:(0,a.jsx)(F.vsM,{className:"text-2xl"}),loading:j,disabled:N,onClick:B,children:"Update local data"}),(0,a.jsxs)("p",{className:"text-sm",children:["Update your local snapshots with the data from AniList. This will overwrite your offline changes. You can automate this in ",(0,a.jsxs)("kbd",{children:["Settings ",">"," Seanime ",">"," Offline"]}),"."]}),(0,a.jsx)(w.w,{}),(0,a.jsx)(x.$n,{intent:"primary-subtle",rounded:!0,className:"w-full",leftIcon:(0,a.jsx)(F.g4b,{className:"text-2xl"}),disabled:j,loading:N,onClick:Q,children:"Upload local changes to AniList"}),(0,a.jsx)("p",{className:"text-sm",children:"Update your AniList lists with the data from your local snapshots. This should be done after you've made changes offline."}),(0,a.jsx)(E.F,{intent:"warning-basic",description:"Changes are irreversible."})]})}),(0,a.jsx)(b,{savedMediaIds:null!=(n=null==u?void 0:u.map(e=>e.mediaId))?n:[]})]})]}),(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{children:"Local storage size: "}),(0,a.jsx)("span",{children:U})]}),I&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.F,{intent:"warning",description:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{children:"You have local changes that have not been synced to AniList."}),(null==i||null==(l=i.settings)||null==(e=l.library)?void 0:e.autoSyncOfflineLocalData)&&(0,a.jsx)("span",{children:" Automatic refreshing of offline data will be paused."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)(x.$n,{intent:"white",leftIcon:(0,a.jsx)(F.g4b,{className:"text-2xl"}),onClick:()=>{Q(),S({updated:!1})},loading:N,disabled:_,children:"Upload local changes"}),(0,a.jsx)(x.$n,{intent:"alert",leftIcon:(0,a.jsx)(L.kAE,{className:"text-2xl"}),onClick:function(){S({updated:!1},{onSuccess:()=>{T.oR.success("Local changes ignored."),B()}})},loading:_,disabled:N,children:"Delete local changes"})]})]})})}),!(null==M?void 0:M.length)&&!(null==R?void 0:R.length)&&(0,a.jsx)(P.D,{title:"No tracked media"}),!!(null==M?void 0:M.length)&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{children:"Saved anime"}),(0,a.jsx)(t.xt,{itemCount:null==M?void 0:M.length,children:null==M?void 0:M.map(e=>{var l,n;return(0,a.jsx)(d.V,{type:"anime",media:e.animeEntry.media,listData:(0,D._1)(e.animeEntry),overlay:!!(null==$||null==(l=$.animeTasks)?void 0:l[e.mediaId])&&(0,a.jsx)(O,{}),containerClassName:(0,g.cn)(!!(null==$||null==(n=$.animeTasks)?void 0:n[e.mediaId])&&"animate-pulse")},e.mediaId)})})]}),!!(null==R?void 0:R.length)&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{children:"Saved manga"}),(0,a.jsx)(t.xt,{itemCount:null==R?void 0:R.length,children:null==R?void 0:R.map(e=>{var l,n;return(0,a.jsx)(d.V,{type:"manga",media:e.mangaEntry.media,listData:(0,D._1)(e.mangaEntry),overlay:!!(null==$||null==(l=$.mangaTasks)?void 0:l[e.mediaId])&&(0,a.jsx)(O,{}),containerClassName:(0,g.cn)(!!(null==$||null==(n=$.mangaTasks)?void 0:n[e.mediaId])&&"animate-pulse")},e.mediaId)})})]})]})}function O(){let e,l=(0,i.c)(1);return l[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsxs)(_.E,{intent:"gray-solid",className:"rounded-tl-md rounded-bl-none rounded-tr-none rounded-br-md bg-gray-950 border gap-0",children:[(0,a.jsx)(k.y$,{className:"size-4 px-0"}),(0,a.jsx)("span",{children:"Syncing"})]}),l[0]=e):e=l[0],e}}},e=>{var l=l=>e(e.s=l);e.O(0,[7518,3873,3380,844,2150,6711,9204,585,5897,5479,4506,6446,8087,9910,5760,7753,8429,7949,8481,2362,512,4613,2202,7825,2592,8095,4791,3351,7401,8211,7654,1597,1518,4809,4500,7814,9499,2571,8154,2,1341,1920,4343,295,9582,6094,2148,5764,5354,6069,7492,8193,1520,582,857,6883,1691,9979,2796,8441,6891,7358],()=>l(39331)),_N_E=e.O()}]);