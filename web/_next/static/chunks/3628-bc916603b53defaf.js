"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3628],{7613:(e,l,t)=>{t.d(l,{B:()=>Z,t:()=>H});var a=t(95155),s=t(19749),n=t(7675),i=t(74889),r=t(46278),o=t(69554),c=t(9478),d=t(75006),u=t(35656),m=t(84127),h=t(91360),p=t(76049),x=t(30033),f=t(53712),v=t(14370),y=t(1925),g=t(98317),b=t(76445),j=t(63981),S=t(29724),N=t(35089),P=t(12115),w=t(70376);function _(e){var l;let{paths:t,setPaths:s,...n}=e,i=(0,S.md)(d.Z),{data:r}=(0,c.My)(),o=P.useRef(!0),[u,h]=P.useState(t);P.useEffect(()=>{if(o.current){o.current=!1;return}h(t)},[t]),P.useEffect(()=>{s(u)},[u]);let j=P.useCallback(e=>{let{active:l,over:t}=e;l.id!==(null==t?void 0:t.id)&&h(e=>{let a=e.indexOf(l.id),s=e.indexOf(null==t?void 0:t.id);return(0,b.be)(e,a,s)})},[]),[N,_]=P.useState("CURRENT"),[C,k]=P.useState(""),A=(0,v.d)(C,500),E=P.useMemo(()=>{var e,l,t,a,s,n,r,o;return 0!==A.length?(null!=(r=null==i||null==(t=i.lists)||null==(l=t.filter(e=>"PLANNING"===e.type||"PAUSED"===e.type||"CURRENT"===e.type))||null==(e=l.flatMap(e=>e.entries))?void 0:e.filter(Boolean))?r:[]).filter(e=>{var l,t,a,s,n,i,r,o;return(null==e||null==(s=e.media)||null==(a=s.title)||null==(t=a.english)||null==(l=t.toLowerCase())?void 0:l.includes(A.toLowerCase()))||(null==e||null==(o=e.media)||null==(r=o.title)||null==(i=r.romaji)||null==(n=i.toLowerCase())?void 0:n.includes(A.toLowerCase()))}):null!=(o=null==i||null==(n=i.lists)||null==(s=n.filter(e=>"-"===N?"PLANNING"===e.type||"PAUSED"===e.type||"CURRENT"===e.type:e.type===N))||null==(a=s.flatMap(e=>e.entries))?void 0:a.filter(Boolean))?o:[]},[i,A,N]);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)(p.a,{title:"Select an anime",contentClass:"max-w-4xl",trigger:(0,a.jsx)(m.$n,{leftIcon:(0,a.jsx)(w.Ca6,{className:"text-2xl"}),intent:"white",className:"rounded-full",disabled:u.length>=10,children:"Add an episode"}),children:[(0,a.jsxs)("div",{className:"grid grid-cols-[150px,1fr] gap-2",children:[(0,a.jsx)(x.l,{value:N,onValueChange:e=>_(e),options:[{label:"Current",value:"CURRENT"},{label:"Paused",value:"PAUSED"},{label:"Planning",value:"PLANNING"},{label:"All",value:"-"}],disabled:0!==C.length}),(0,a.jsx)(f.k,{placeholder:"Search",value:C,onChange:e=>k(e.target.value)})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:null==E?void 0:E.map(e=>(0,a.jsx)(I,{entry:e,paths:u,setPaths:h},e.mediaId))})]})}),(0,a.jsx)(y.Mp,{modifiers:[g.FN],onDragEnd:j,children:(0,a.jsx)(b.gB,{strategy:b._G,items:u,children:(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)("ul",{className:"space-y-2",children:null==(l=u.map(e=>null==r?void 0:r.find(l=>l.path===e)))?void 0:l.filter(Boolean).map((e,l)=>{var t,s,n,r;return(0,a.jsx)(L,{id:e.path,localFile:e,media:null==i||null==(r=i.lists)||null==(n=r.flatMap(e=>e.entries))||null==(s=n.filter(Boolean))||null==(t=s.find(l=>(null==e?void 0:e.mediaId)===l.mediaId))?void 0:t.media,setPaths:h},e.path)})})})})})]})}function I(e){var l,t,n,i,r,o,c,d,m,h,x;let f,v,y,g,b,j,S,P=(0,s.c)(18),{entry:w,paths:_,setPaths:I}=e,L=(null==(t=w.media)||null==(l=t.title)?void 0:l.userPreferred)||(null==(i=w.media)||null==(n=i.title)?void 0:n.romaji)||"",k=w.mediaId,A=(null==(o=w.media)||null==(r=o.coverImage)?void 0:r.large)||(null==(c=w.media)?void 0:c.bannerImage)||"";P[0]===Symbol.for("react.memo_cache_sentinel")?(f=(0,u.r)(700,475),P[0]=f):f=P[0],P[1]!==A?(v=(0,a.jsx)(N.default,{src:A,placeholder:f,sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover"}),P[1]=A,P[2]=v):v=P[2];let E=(null==(m=w.media)||null==(d=m.title)?void 0:d.userPreferred)||(null==(x=w.media)||null==(h=x.title)?void 0:h.romaji);return P[3]!==E?(y=(0,a.jsx)("p",{className:"line-clamp-2 text-sm absolute m-2 bottom-0 font-semibold z-[10]",children:E}),P[3]=E,P[4]=y):y=P[4],P[5]===Symbol.for("react.memo_cache_sentinel")?(g=(0,a.jsx)("div",{className:"z-[5] absolute bottom-0 w-full h-[80%] bg-gradient-to-t from-[--background] to-transparent"}),P[5]=g):g=P[5],P[6]!==w.mediaId||P[7]!==v||P[8]!==y?(b=(0,a.jsxs)("div",{className:"col-span-1 aspect-[6/7] rounded-[--radius-md] border overflow-hidden relative transition cursor-pointer bg-[var(--background)] md:opacity-60 md:hover:opacity-100",children:[v,y,g]},k),P[6]=w.mediaId,P[7]=v,P[8]=y,P[9]=b):b=P[9],P[10]!==w||P[11]!==_||P[12]!==I?(j=(0,a.jsx)(C,{selectedPaths:_,setSelectedPaths:I,entry:w}),P[10]=w,P[11]=_,P[12]=I,P[13]=j):j=P[13],P[14]!==L||P[15]!==b||P[16]!==j?(S=(0,a.jsx)(p.a,{title:L,trigger:b,children:j}),P[14]=L,P[15]=b,P[16]=j,P[17]=S):S=P[17],S}function L(e){var l,t,n,i;let r,o,c,d,h,p,x,f,v,y,g,S,P,_,I,L=(0,s.c)(57),{localFile:C,id:k,media:A,setPaths:E}=e;L[0]!==k?(r={id:k},L[0]=k,L[1]=r):r=L[1];let{attributes:T,listeners:F,setNodeRef:Y,transform:U,transition:K}=(0,b.gl)(r);L[2]!==U?(o=j.Ks.Transform.toString(U),L[2]=U,L[3]=o):o=L[3],L[4]!==o||L[5]!==K?(c={transform:o,transition:K},L[4]=o,L[5]=K,L[6]=c):c=L[6];let R=c;if(!C)return null;if(!A){let e,l,t,s,n,i,r;return L[7]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(w.id1,{}),L[7]=e):e=L[7],L[8]!==k||L[9]!==E?(l=(0,a.jsx)(m.K0,{className:"absolute top-2 right-2 rounded-full",icon:e,intent:"alert-subtle",size:"sm",onClick:()=>E(e=>e.filter(e=>e!==k))}),L[8]=k,L[9]=E,L[10]=l):l=L[10],L[11]!==T||L[12]!==F?(t=(0,a.jsx)("div",{className:"rounded-full w-4 h-auto bg-[--muted] md:bg-[--subtle] md:hover:bg-[--subtle-highlight] cursor-move",...T,...F}),L[11]=T,L[12]=F,L[13]=t):t=L[13],L[14]===Symbol.for("react.memo_cache_sentinel")?(s=(0,a.jsxs)("p",{className:"text-lg text-white font-semibold",children:[(0,a.jsx)("span",{children:"???"}),(0,a.jsx)("span",{className:"text-gray-400 font-medium max-w-lg truncate"})]}),L[14]=s):s=L[14],L[15]!==C.name?(n=(0,a.jsxs)("div",{children:[s,(0,a.jsx)("p",{className:"text-sm text-[--muted] font-normal italic line-clamp-1",children:C.name})]}),L[15]=C.name,L[16]=n):n=L[16],L[17]!==l||L[18]!==t||L[19]!==n?(i=(0,a.jsxs)("div",{className:"px-2.5 py-2 bg-[var(--background)] border-[--red] rounded-[--radius-md] border flex gap-3 relative",children:[l,t,n]}),L[17]=l,L[18]=t,L[19]=n,L[20]=i):i=L[20],L[21]!==Y||L[22]!==R||L[23]!==i?(r=(0,a.jsx)("li",{ref:Y,style:R,children:i}),L[21]=Y,L[22]=R,L[23]=i,L[24]=r):r=L[24],r}L[25]===Symbol.for("react.memo_cache_sentinel")?(d=(0,a.jsx)(w.id1,{}),L[25]=d):d=L[25],L[26]!==k||L[27]!==E?(h=(0,a.jsx)(m.K0,{className:"absolute top-2 right-2 rounded-full",icon:d,intent:"alert-subtle",size:"sm",onClick:()=>E(e=>e.filter(e=>e!==k))}),L[26]=k,L[27]=E,L[28]=h):h=L[28],L[29]!==T||L[30]!==F?(p=(0,a.jsx)("div",{className:"rounded-full w-4 h-auto bg-[--muted] md:bg-[--subtle] md:hover:bg-[--subtle-highlight] cursor-move",...T,...F}),L[29]=T,L[30]=F,L[31]=p):p=L[31];let z=(null==A||null==(l=A.coverImage)?void 0:l.large)||(null==A?void 0:A.bannerImage)||"";L[32]===Symbol.for("react.memo_cache_sentinel")?(x=(0,u.r)(700,475),L[32]=x):x=L[32],L[33]!==z?(f=(0,a.jsx)("div",{className:"w-16 aspect-square rounded-[--radius-md] border overflow-hidden relative transition bg-[var(--background)]",children:(0,a.jsx)(N.default,{src:z,placeholder:x,sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover"})}),L[33]=z,L[34]=f):f=L[34],L[35]!==C.metadata||L[36]!==(null==A?void 0:A.format)?(v=C.metadata&&(0,a.jsx)("p",{children:(null==A?void 0:A.format)!=="MOVIE"?"Episode ".concat(null==(i=C.metadata)?void 0:i.episode):"Movie"}),L[35]=C.metadata,L[36]=null==A?void 0:A.format,L[37]=v):v=L[37];let G=(null==A||null==(t=A.title)?void 0:t.userPreferred)||(null==A||null==(n=A.title)?void 0:n.romaji);return L[38]!==G?(y=(0,a.jsxs)("p",{className:"max-w-full truncate text-gray-400 font-medium max-w-lg truncate",children:[" - ",G]}),L[38]=G,L[39]=y):y=L[39],L[40]!==v||L[41]!==y?(g=(0,a.jsxs)("div",{className:"text-lg text-white font-semibold flex gap-1",children:[v,y]}),L[40]=v,L[41]=y,L[42]=g):g=L[42],L[43]!==C.name?(S=(0,a.jsx)("p",{className:"text-sm text-[--muted] font-normal italic line-clamp-1",children:C.name}),L[43]=C.name,L[44]=S):S=L[44],L[45]!==g||L[46]!==S?(P=(0,a.jsxs)("div",{children:[g,S]}),L[45]=g,L[46]=S,L[47]=P):P=L[47],L[48]!==P||L[49]!==h||L[50]!==p||L[51]!==f?(_=(0,a.jsxs)("div",{className:"px-2.5 py-2 bg-[var(--background)] rounded-[--radius-md] border flex gap-3 relative",children:[h,p,f,P]}),L[48]=P,L[49]=h,L[50]=p,L[51]=f,L[52]=_):_=L[52],L[53]!==Y||L[54]!==R||L[55]!==_?(I=(0,a.jsx)("li",{ref:Y,style:R,children:_}),L[53]=Y,L[54]=R,L[55]=_,L[56]=I):I=L[56],I}function C(e){var l,t,r,c,d;let u,m,p,x=(0,s.c)(10),{entry:f,selectedPaths:v,setSelectedPaths:y}=e,{data:g}=function(e,l){let t,a,r,o=(0,s.c)(10);o[0]!==e||o[1]!==l?(t=i.S.PLAYLIST.GetPlaylistEpisodes.endpoint.replace("{id}",String(e)).replace("{progress}",String(l||0)),o[0]=e,o[1]=l,o[2]=t):t=o[2];let c=String(e),d=String(l||0);o[3]!==c||o[4]!==d?(a=[i.S.PLAYLIST.GetPlaylistEpisodes.key,c,d],o[3]=c,o[4]=d,o[5]=a):a=o[5];let u=!!e;return o[6]!==t||o[7]!==a||o[8]!==u?(r={endpoint:t,method:i.S.PLAYLIST.GetPlaylistEpisodes.methods[0],queryKey:a,enabled:u},o[6]=t,o[7]=a,o[8]=u,o[9]=r):r=o[9],(0,n.fl)(r)}(f.mediaId,(null==(l=f.listData)?void 0:l.progress)||0);x[0]!==v||x[1]!==y?(u=e=>{v.length<=10?y(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e]):o.oR.error("You can't add more than 10 episodes to a playlist")},x[0]=v,x[1]=y,x[2]=u):u=x[2];let b=u;return x[3]!==g||x[4]!==(null==(t=f.media)?void 0:t.format)||x[5]!==b||x[6]!==v?(m=null==g||null==(c=g.filter(A))||null==(r=c.sort(k))?void 0:r.map(e=>{var l;return(0,a.jsxs)("div",{className:(0,h.cn)("px-2.5 py-2 bg-[var(--background)] rounded-[--radius-md] border cursor-pointer opacity-80 max-w-full",v.includes(e.path)?"bg-gray-800 opacity-100 text-white ring-1 ring-[--zinc]":"hover:bg-[--subtle]","transition"),onClick:()=>b(e.path),children:[(0,a.jsx)("p",{className:"",children:(null==(l=f.media)?void 0:l.format)!=="MOVIE"?"Episode ".concat(e.metadata.episode):"Movie"}),(0,a.jsx)("p",{className:"text-sm text-[--muted] font-normal italic max-w-lg line-clamp-1",children:e.name})]},e.path)}),x[3]=g,x[4]=null==(d=f.media)?void 0:d.format,x[5]=b,x[6]=v,x[7]=m):m=x[7],x[8]!==m?(p=(0,a.jsx)("div",{className:"flex flex-col gap-2 overflow-auto p-1",children:m}),x[8]=m,x[9]=p):p=x[9],p}function k(e,l){return e.metadata.episode-l.metadata.episode}function A(e){return!!e.metadata}var E=t(35354),T=t(98836);function F(e){var l,t,c;let d,u,h,x,v,y,g,b,j,S,N,w,I,L,C,k=(0,s.c)(44),{playlist:A,trigger:F}=e,[K,R]=P.useState(!1),[z,G]=P.useState(null!=(l=null==A?void 0:A.name)?l:"");k[0]!==(null==A?void 0:A.localFiles)?(d=null!=(c=null==A||null==(t=A.localFiles)?void 0:t.map(U))?c:[],k[0]=null==A?void 0:A.localFiles,k[1]=d):d=k[1];let[q,M]=P.useState(d),D=!!A,{mutate:O,isPending:B}=function(){let e,l,t=(0,s.c)(3),a=(0,r.jE)();return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.PLAYLIST.CreatePlaylist.key],t[0]=e):e=t[0],t[1]!==a?(l={endpoint:i.S.PLAYLIST.CreatePlaylist.endpoint,method:i.S.PLAYLIST.CreatePlaylist.methods[0],mutationKey:e,onSuccess:async()=>{await a.invalidateQueries({queryKey:[i.S.PLAYLIST.GetPlaylists.key]}),o.oR.success("Playlist created")}},t[1]=a,t[2]=l):l=t[2],(0,n.qk)(l)}(),{mutate:Q,isPending:V}=function(){let e,l,t=(0,s.c)(3),a=(0,r.jE)();return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.PLAYLIST.DeletePlaylist.key],t[0]=e):e=t[0],t[1]!==a?(l={endpoint:i.S.PLAYLIST.DeletePlaylist.endpoint,method:i.S.PLAYLIST.DeletePlaylist.methods[0],mutationKey:e,onSuccess:async()=>{await a.invalidateQueries({queryKey:[i.S.PLAYLIST.GetPlaylists.key]}),o.oR.success("Playlist deleted")}},t[1]=a,t[2]=l):l=t[2],(0,n.qk)(l)}(),{mutate:$,isPending:W}=function(){let e,l,t=(0,s.c)(3),a=(0,r.jE)();return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=[i.S.PLAYLIST.UpdatePlaylist.key],t[0]=e):e=t[0],t[1]!==a?(l={endpoint:i.S.PLAYLIST.UpdatePlaylist.endpoint,method:i.S.PLAYLIST.UpdatePlaylist.methods[0],mutationKey:e,onSuccess:async()=>{await a.refetchQueries({queryKey:[i.S.PLAYLIST.GetPlaylists.key]}),o.oR.success("Playlist updated")}},t[1]=a,t[2]=l):l=t[2],(0,n.qk)(l)}();k[2]===Symbol.for("react.memo_cache_sentinel")?(u=function(){G(""),M([])},k[2]=u):u=k[2];let H=u;k[3]!==D||k[4]!==A?(h=()=>{D&&A&&A.localFiles&&(G(A.name),M(A.localFiles.map(Y)))},k[3]=D,k[4]=A,k[5]=h):h=k[5],k[6]!==K||k[7]!==A?(x=[A,K],k[6]=K,k[7]=A,k[8]=x):x=k[8],P.useEffect(h,x),k[9]!==O||k[10]!==D||k[11]!==z||k[12]!==q||k[13]!==A||k[14]!==$?(v=function(){if(0===z.length)return void o.oR.error("Please enter a name for the playlist");D&&A?$({dbId:A.dbId,name:z,paths:q}):(R(!1),O({name:z,paths:q},{onSuccess:()=>{H()}}))},k[9]=O,k[10]=D,k[11]=z,k[12]=q,k[13]=A,k[14]=$,k[15]=v):v=k[15];let Z=v,X=D?"Edit playlist":"Create a playlist";k[16]===Symbol.for("react.memo_cache_sentinel")?(y=e=>R(e),k[16]=y):y=k[16],k[17]===Symbol.for("react.memo_cache_sentinel")?(g=e=>G(e.target.value),k[17]=g):g=k[17],k[18]!==z?(b=(0,a.jsx)(f.k,{label:"Name",value:z,onChange:g}),k[18]=z,k[19]=b):b=k[19],k[20]===Symbol.for("react.memo_cache_sentinel")?(j=(0,a.jsx)(T.w,{}),k[20]=j):j=k[20],k[21]!==q?(S=(0,a.jsx)(_,{paths:q,setPaths:M}),k[21]=q,k[22]=S):S=k[22];let J=0===q.length,ee=B||V||W,el=D?"Update":"Create";return k[23]!==Z||k[24]!==J||k[25]!==ee||k[26]!==el?(N=(0,a.jsx)("div",{className:"",children:(0,a.jsx)(m.$n,{disabled:J,onClick:Z,loading:ee,children:el})}),k[23]=Z,k[24]=J,k[25]=ee,k[26]=el,k[27]=N):N=k[27],k[28]!==S||k[29]!==N||k[30]!==b?(w=(0,a.jsxs)("div",{className:"space-y-4",children:[b,j,S,N]}),k[28]=S,k[29]=N,k[30]=b,k[31]=w):w=k[31],k[32]!==Q||k[33]!==D||k[34]!==A?(I=D&&(0,a.jsx)(E.mw,{actionText:"Delete playlist",onDelete:()=>{D&&A&&Q({dbId:A.dbId},{onSuccess:()=>{R(!1)}})}}),k[32]=Q,k[33]=D,k[34]=A,k[35]=I):I=k[35],k[36]!==w||k[37]!==I?(L=(0,a.jsxs)("div",{className:"space-y-4",children:[w,I]}),k[36]=w,k[37]=I,k[38]=L):L=k[38],k[39]!==K||k[40]!==L||k[41]!==X||k[42]!==F?(C=(0,a.jsx)(p.a,{title:X,trigger:F,open:K,onOpenChange:y,contentClass:"max-w-4xl",children:L}),k[39]=K,k[40]=L,k[41]=X,k[42]=F,k[43]=C):C=k[43],C}function Y(e){return e.path}function U(e){return e.path}var K=t(10109),R=t(3692);function z(e){var l;let t,n,i,r,o,c,d,u,h,x=(0,s.c)(24),{trigger:f,playlist:v,canStart:y,onPlaylistLoaded:g}=e;x[0]!==g?(t={onSuccess:g},x[0]=g,x[1]=t):t=x[1];let{mutate:b,isPending:j}=(0,K.PV)(t);if(!(null==v||null==(l=v.localFiles)?void 0:l.length))return null;x[2]!==v.name?(n=(0,a.jsxs)("strong",{children:['"',v.name,'"']}),x[2]=v.name,x[3]=n):n=x[3];let S=v.localFiles.length>1?"s":"";x[4]!==v.localFiles.length||x[5]!==n||x[6]!==S?(i=(0,a.jsxs)("p",{className:"text-center",children:["You are about to start the playlist ",n,", which contains ",v.localFiles.length," episode",S,"."]}),x[4]=v.localFiles.length,x[5]=n,x[6]=S,x[7]=i):i=x[7],x[8]===Symbol.for("react.memo_cache_sentinel")?(r=(0,a.jsx)("p",{className:"text-[--muted] text-center",children:"Reminder: The playlist will be deleted once you start it, whether you finish it or not."}),x[8]=r):r=x[8],x[9]!==y?(o=!y&&(0,a.jsx)("p",{className:"text-orange-300 text-center",children:'Please enable "Automatically update progress" to start'}),x[9]=y,x[10]=o):o=x[10],x[11]===Symbol.for("react.memo_cache_sentinel")?(c=(0,a.jsx)(R.gSK,{}),x[11]=c):c=x[11];let N=!y;return x[12]!==v.dbId||x[13]!==b?(d=()=>b({dbId:v.dbId}),x[12]=v.dbId,x[13]=b,x[14]=d):d=x[14],x[15]!==j||x[16]!==N||x[17]!==d?(u=(0,a.jsx)(m.$n,{className:"w-full flex-none",leftIcon:c,intent:"primary",size:"lg",loading:j,disabled:N,onClick:d,children:"Start"}),x[15]=j,x[16]=N,x[17]=d,x[18]=u):u=x[18],x[19]!==i||x[20]!==o||x[21]!==u||x[22]!==f?(h=(0,a.jsxs)(p.a,{title:"Start playlist",titleClass:"text-center",trigger:f,children:[i,r,o,u]}),x[19]=i,x[20]=o,x[21]=u,x[22]=f,x[23]=h):h=x[23],h}var G=t(48555),q=t(18292),M=t(37817),D=t(80677),O=t(2091),B=t(19022),Q=t(41452);function V(e){let{}=e,{data:l,isLoading:t}=function(){let e,l=(0,s.c)(1);return l[0]===Symbol.for("react.memo_cache_sentinel")?(e={endpoint:i.S.PLAYLIST.GetPlaylists.endpoint,method:i.S.PLAYLIST.GetPlaylists.methods[0],queryKey:[i.S.PLAYLIST.GetPlaylists.key],enabled:!0},l[0]=e):e=l[0],(0,n.fl)(e)}(),r=(0,S.md)(G.Qy),o=(0,M.v1)(),c=(0,S.Xr)(H),d=P.useCallback(()=>{c(!1)},[]);return t?(0,a.jsx)(O.kt,{}):(null==l?void 0:l.length)?(0,a.jsxs)(D.FN,{className:"w-full max-w-full",gap:"none",opts:{align:"start"},children:[(0,a.jsx)(D.h1,{}),(0,a.jsx)(D.Wk,{children:l.map(e=>{var l,t,s,n;let i=null==r?void 0:r.find(l=>{var t,a;return l.id===(null==(a=e.localFiles)||null==(t=a[0])?void 0:t.mediaId)});return(0,a.jsx)(D.A7,{className:(0,h.cn)("md:basis-1/3 lg:basis-1/4 2xl:basis-1/6 min-[2000px]:basis-1/6","aspect-[7/6] p-2"),children:(0,a.jsxs)("div",{className:"group/playlist-item flex gap-3 h-full justify-between items-center bg-gray-950 rounded-[--radius-md] transition relative overflow-hidden",children:[((null==i||null==(l=i.coverImage)?void 0:l.large)||(null==i?void 0:i.bannerImage))&&(0,a.jsx)(N.default,{src:(null==i||null==(t=i.coverImage)?void 0:t.extraLarge)||(null==i?void 0:i.bannerImage)||"",placeholder:(0,u.r)(700,475),sizes:"10rem",fill:!0,alt:"",className:"object-center object-cover z-[1]"}),(0,a.jsx)("div",{className:"absolute inset-0 z-[2] bg-gray-900 opacity-50 hover:opacity-70 transition-opacity flex items-center justify-center"}),(0,a.jsx)("div",{className:"absolute inset-0 z-[6] flex items-center justify-center",children:(0,a.jsx)(z,{canStart:null==o||null==(n=o.settings)||null==(s=n.library)?void 0:s.autoUpdateProgress,playlist:e,onPlaylistLoaded:d,trigger:(0,a.jsx)(B.Yay,{className:"block text-5xl cursor-pointer opacity-50 hover:opacity-100 transition-opacity"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 z-[6] flex items-center justify-center",children:(0,a.jsx)(F,{trigger:(0,a.jsx)(m.$n,{className:"w-full flex-none rounded-full",leftIcon:(0,a.jsx)(w.VZ_,{}),intent:"white-subtle",size:"sm",children:"Edit"}),playlist:e})}),(0,a.jsx)("div",{className:"absolute w-full bottom-0 h-fit z-[6]",children:(0,a.jsxs)("div",{className:"space-y-0 pb-3 items-center",children:[(0,a.jsx)("p",{className:"text-md font-bold text-white max-w-lg truncate text-center",children:e.name}),e.localFiles&&(0,a.jsxs)("p",{className:"text-sm text-[--muted] font-normal line-clamp-1 text-center",children:[e.localFiles.length," episode",e.localFiles.length>1?"s":""]})]})}),(0,a.jsx)(q.H,{})]})},e.dbId)})})]}):(0,a.jsxs)("div",{className:"text-center text-[--muted] space-y-1",children:[(0,a.jsx)(Q.wHW,{className:"mx-auto text-5xl text-[--muted]"}),(0,a.jsx)("div",{children:"No playlists"})]})}var $=t(50558),W=t(15388);let H=(0,t(42500).eU)(!1);function Z(e){var l,t,n,i,r,o;let c,d,u,h,p,x,f,v=(0,s.c)(13),y=(0,M.v1)(),[g,b]=(0,S.fp)(H);return v[0]!==b?(c=e=>b(e),v[0]=b,v[1]=c):c=v[1],v[2]===Symbol.for("react.memo_cache_sentinel")?(d=(0,a.jsx)("h4",{children:"Playlists"}),v[2]=d):d=v[2],v[3]===Symbol.for("react.memo_cache_sentinel")?(u=(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[d,(0,a.jsx)("div",{className:"flex gap-2 items-center md:pr-8",children:(0,a.jsx)(F,{trigger:(0,a.jsx)(m.$n,{intent:"white",className:"rounded-full",children:"Add a playlist"})})})]}),v[3]=u):u=v[3],v[4]!==(null==y||null==(t=y.settings)||null==(l=t.library)?void 0:l.autoUpdateProgress)?(h=!(null==y||null==(i=y.settings)||null==(n=i.library)?void 0:n.autoUpdateProgress)&&(0,a.jsx)($.F,{className:"max-w-2xl mx-auto",intent:"warning",description:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("p",{children:'You need to enable "Automatically update progress" to use playlists.'})})}),v[4]=null==y||null==(o=y.settings)||null==(r=o.library)?void 0:r.autoUpdateProgress,v[5]=h):h=v[5],v[6]===Symbol.for("react.memo_cache_sentinel")?(p=(0,a.jsx)("div",{className:"",children:(0,a.jsx)(V,{})}),v[6]=p):p=v[6],v[7]!==h?(x=(0,a.jsxs)("div",{className:"space-y-6",children:[u,h,p]}),v[7]=h,v[8]=x):x=v[8],v[9]!==g||v[10]!==c||v[11]!==x?(f=(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(W._s,{open:g,onOpenChange:c,size:"lg",side:"bottom",contentClass:"",children:x})}),v[9]=g,v[10]=c,v[11]=x,v[12]=f):f=v[12],f}},29648:(e,l,t)=>{t.d(l,{U6:()=>N,gw:()=>S,ho:()=>j});var a=t(95155),s=t(19749),n=t(7675),i=t(74889),r=t(46278),o=t(69554),c=t(83563),d=t(37817),u=t(36808),m=t(84127),h=t(76049),p=t(98836),x=t(60695),f=t(73832),v=t(42500),y=t(29724),g=t(12115),b=t(75780);let j=(0,v.eU)(!1),S=(0,v.eU)(!1);function N(){var e,l;let t,v,N,I,L,C,k,A,E,T,F,Y,U,K,R,z,G,q,M,D,O,B=(0,s.c)(54),Q=(0,d.v1)(),[V,$]=(0,y.fp)(j),[,W]=(0,y.fp)(S),H=(0,f.C)(!0),Z=(0,f.C)(!0),X=(0,f.C)(!0);B[0]!==$?(t=()=>{$(!1)},B[0]=$,B[1]=t):t=B[1];let{mutate:J,isPending:ee}=function(e){let l,t,a=(0,s.c)(4),c=(0,r.jE)();return a[0]===Symbol.for("react.memo_cache_sentinel")?(l=[i.S.SCAN.ScanLocalFiles.key],a[0]=l):l=a[0],a[1]!==e||a[2]!==c?(t={endpoint:i.S.SCAN.ScanLocalFiles.endpoint,method:i.S.SCAN.ScanLocalFiles.methods[0],mutationKey:l,onSuccess:async()=>{await c.invalidateQueries({queryKey:[i.S.ANIME_COLLECTION.GetLibraryCollection.key]}),o.oR.success("Library scanned"),await c.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetMissingEpisodes.key]}),await c.invalidateQueries({queryKey:[i.S.AUTO_DOWNLOADER.GetAutoDownloaderItems.key]}),await c.invalidateQueries({queryKey:[i.S.ANIME_ENTRIES.GetAnimeEntry.key]}),null==e||e()}},a[1]=e,a[2]=c,a[3]=t):t=a[3],(0,n.qk)(t)}(t);B[2]!==ee||B[3]!==W?(v=()=>{W(ee)},B[2]=ee,B[3]=W,B[4]=v):v=B[4],B[5]!==ee?(N=[ee],B[5]=ee,B[6]=N):N=B[6],g.useEffect(v,N),B[7]!==H.active||B[8]!==J||B[9]!==$||B[10]!==X.active||B[11]!==Z.active?(I=function(){J({enhanced:!H.active,skipLockedFiles:Z.active,skipIgnoredFiles:X.active}),$(!1)},B[7]=H.active,B[8]=J,B[9]=$,B[10]=X.active,B[11]=Z.active,B[12]=I):I=B[12];let el=I,{inject:et,remove:ea}=(0,c.H)();B[13]!==el||B[14]!==et||B[15]!==ea?(L=()=>(et("scanner-controls",{priority:1,items:[{id:"refresh",value:"refresh",heading:"Library",render:_,onSelect:e=>{let{ctx:l}=e;l.close(),setTimeout(()=>{el()},500)},showBasedOnInput:"startsWith"}],filter:w,shouldShow:P,showBasedOnInput:"startsWith"}),()=>ea("scanner-controls")),B[13]=el,B[14]=et,B[15]=ea,B[16]=L):L=B[16],B[17]===Symbol.for("react.memo_cache_sentinel")?(C=[],B[17]=C):C=B[17],g.useEffect(L,C),B[18]!==$?(k=e=>{$(e)},B[18]=$,B[19]=k):k=B[19],B[20]===Symbol.for("react.memo_cache_sentinel")?(A=(0,a.jsx)("div",{"data-scanner-modal-top-pattern":!0,className:"!mt-0 bg-[url(/pattern-2.svg)] z-[-1] w-full h-[4rem] absolute opacity-40 top-0 left-0 bg-no-repeat bg-right bg-cover",children:(0,a.jsx)("div",{className:"w-full absolute top-0 h-full bg-gradient-to-t from-[--background] to-transparent z-[-2]"})}),B[20]=A):A=B[20],B[21]===Symbol.for("react.memo_cache_sentinel")?(E=(0,a.jsx)("h5",{className:"text-[--muted]",children:"Local files"}),B[21]=E):E=B[21],B[22]!==Z?(T=e=>Z.set(e),B[22]=Z,B[23]=T):T=B[23],B[24]!==Z.active||B[25]!==T?(F=(0,a.jsx)(x.d,{side:"right",label:"Skip locked files",value:Z.active,onValueChange:T}),B[24]=Z.active,B[25]=T,B[26]=F):F=B[26],B[27]!==X?(Y=e=>X.set(e),B[27]=X,B[28]=Y):Y=B[28],B[29]!==X.active||B[30]!==Y?(U=(0,a.jsx)(x.d,{side:"right",label:"Skip ignored files",value:X.active,onValueChange:Y}),B[29]=X.active,B[30]=Y,B[31]=U):U=B[31],B[32]===Symbol.for("react.memo_cache_sentinel")?(K=(0,a.jsx)(p.w,{}),B[32]=K):K=B[32],B[33]===Symbol.for("react.memo_cache_sentinel")?(R=(0,a.jsx)("h5",{className:"text-[--muted]",children:"Matching data"}),B[33]=R):R=B[33],B[34]!==H?(z=e=>H.set(e),B[34]=H,B[35]=z):z=B[35];let es=H.active?"":"Caution: Slower for large libraries";B[36]!==H.active||B[37]!==z||B[38]!==es?(G=(0,a.jsxs)(u.KZ,{className:"space-y-2",children:[R,(0,a.jsx)(x.d,{side:"right",label:"Use my AniList lists only",moreHelp:"Disabling this will cause Seanime to use more requests which may lead to rate limits and slower scanning",value:H.active,onValueChange:z,help:es})]}),B[36]=H.active,B[37]=z,B[38]=es,B[39]=G):G=B[39],B[40]!==F||B[41]!==U||B[42]!==G?(q=(0,a.jsx)("div",{className:"space-y-4 mt-6","data-scanner-modal-content":!0,children:(0,a.jsxs)(u.KZ,{className:"space-y-2",children:[E,F,U,K,G]})}),B[40]=F,B[41]=U,B[42]=G,B[43]=q):q=B[43],B[44]===Symbol.for("react.memo_cache_sentinel")?(M=(0,a.jsx)(b.CKj,{}),B[44]=M):M=B[44];let en=!(null==Q||null==(l=Q.settings)||null==(e=l.library)?void 0:e.libraryPath);return B[45]!==el||B[46]!==ee||B[47]!==en?(D=(0,a.jsx)(m.$n,{onClick:el,intent:"primary",leftIcon:M,loading:ee,className:"w-full",disabled:en,children:"Scan"}),B[45]=el,B[46]=ee,B[47]=en,B[48]=D):D=B[48],B[49]!==V||B[50]!==q||B[51]!==D||B[52]!==k?(O=(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(h.a,{"data-scanner-modal":!0,open:V,onOpenChange:k,titleClass:"text-center",contentClass:"space-y-4 max-w-2xl overflow-hidden",children:[A,q,D]})}),B[49]=V,B[50]=q,B[51]=D,B[52]=k,B[53]=O):O=B[53],O}function P(e){let{ctx:l}=e;return"/"===l.router.pathname}function w(e){let{item:l,input:t}=e;return!t||l.value.toLowerCase().includes(t.toLowerCase())}function _(){return(0,a.jsx)("p",{children:"Refresh library"})}}}]);